{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to Peek Stash Browser","text":"<p>A modern web application for browsing and streaming your Stash adult content library with adaptive video streaming, playlists, and watch history tracking.</p> <ul> <li> Quick Start</li> </ul> <p>Get up and running in minutes with Docker or unRAID</p> <p> Installation</p> <ul> <li> Configuration</li> </ul> <p>Set up Peek to connect with your Stash server</p> <p> Setup Guide</p> <ul> <li> Troubleshooting</li> </ul> <p>Common issues and solutions</p> <p> Get Help</p>"},{"location":"#what-is-peek","title":"What is Peek?","text":"<p>Peek is a web-based browser for your Stash library, offering a sleek modern interface for browsing your \"documentary\" collection.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Adaptive Video Streaming - Real-time HLS transcoding with multiple quality options (720p/480p/360p)</li> <li>Watch History Tracking - Automatic progress tracking and resume playback (Learn more)</li> <li>Playlist Management - Create, organize, and play custom playlists (Learn more)</li> <li>Modern Interface - Responsive React UI with theme support</li> <li>Full Keyboard Navigation - Complete TV remote and keyboard control support (Learn more)</li> <li>Mobile Ready - Optimized for all devices</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"DockerunRAID <pre><code>docker run -d \\\n  --name peek-stash-browser \\\n  -p 6969:80 \\\n  -v /path/to/stash/media:/app/media:ro \\\n  -v /path/to/peek/data:/app/data \\\n  -e STASH_URL=\"http://your-stash:9999/graphql\" \\\n  -e STASH_API_KEY=\"your_api_key\" \\\n  carrotwaxr/peek-stash-browser:latest\n</code></pre> <ol> <li>Open Community Applications</li> <li>Search for \"Peek Stash Browser\"</li> <li>Click Install and configure</li> <li>Access at <code>http://your-unraid-ip:6969</code></li> </ol>"},{"location":"#first-login","title":"First Login","text":"<p>Default Credentials:</p> <ul> <li>Username: <code>admin</code></li> <li>Password: <code>admin</code></li> </ul> <p>Change Default Password</p> <p>Immediately change your password after first login via Settings \u2192 My Settings</p>"},{"location":"#requirements","title":"Requirements","text":"<ul> <li>Stash server with GraphQL API enabled</li> <li>Docker (or unRAID)</li> <li>Network access between Peek and Stash</li> <li>Shared media storage accessible to both containers</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<p>Peek uses a single-container architecture:</p> <ul> <li>Frontend: React 19 app served by nginx</li> <li>Backend: Node.js/Express API server (proxied through nginx)</li> <li>Database: SQLite (embedded, no separate container)</li> <li>Transcoding: FFmpeg for real-time video conversion</li> </ul>"},{"location":"#community-support","title":"Community &amp; Support","text":"<ul> <li>Bug Reports: GitHub Issues</li> <li>Feature Requests: GitHub Issues</li> <li>Stash Community: Discord - #third-party-integrations channel</li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the MIT License.</p>"},{"location":"#acknowledgments","title":"Acknowledgments","text":"<p>Built with Stash, React, Express, FFmpeg, and other amazing open source projects.</p>"},{"location":"development/content-restrictions/","title":"Content Restrictions System","text":""},{"location":"development/content-restrictions/#overview","title":"Overview","text":"<p>The Content Restrictions system allows administrators to control what content each user can see in Peek. This is a critical privacy/safety feature that enables hiding sensitive content (e.g., scenes with certain tags, studios, or groups) on a per-user basis.</p> <p>Current Version: 1.5.3+ Status: Fixed - Critical cascading bugs resolved (January 2025)</p>"},{"location":"development/content-restrictions/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Architecture</li> <li>Database Schema</li> <li>How It Works</li> <li>Cascading Logic</li> <li>Empty Entity Filtering</li> <li>Caching Strategy</li> <li>API Endpoints</li> <li>Code Flow</li> <li>Known Issues &amp; Edge Cases</li> <li>Testing Strategy</li> </ol>"},{"location":"development/content-restrictions/#architecture","title":"Architecture","text":"<p>The system consists of several cooperating services:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     User Request                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   Library Controller          \u2502\n         \u2502   (scenes, performers, etc.)  \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502                                                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 StashCacheManager \u2502    \u2502 UserRestriction    \u2502    \u2502 FilteredEntity  \u2502\n\u2502                   \u2502\u2500\u2500\u2500\u2500\u25b6\u2502 Service            \u2502\u2500\u2500\u2500\u2500\u25b6\u2502 CacheService    \u2502\n\u2502 (Server-wide data)\u2502    \u2502 (Apply restrictions)\u2502    \u2502 (Per-user cache)\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                    \u2502\n                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                         \u2502 EmptyEntityFilter   \u2502\n                         \u2502 Service             \u2502\n                         \u2502 (Remove orphans)    \u2502\n                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"development/content-restrictions/#key-services","title":"Key Services","text":"<ol> <li>StashCacheManager (<code>server/services/StashCacheManager.ts</code>)</li> <li>Manages server-wide cache of all Stash entities</li> <li>Refreshes hourly from Stash GraphQL API</li> <li> <p>Provides fast Map-based lookups</p> </li> <li> <p>UserRestrictionService (<code>server/services/UserRestrictionService.ts</code>)</p> </li> <li>Applies per-user INCLUDE/EXCLUDE rules</li> <li>Filters Scenes based on Groups, Tags, Studios, Galleries</li> <li> <p>Filters organizational entities (Groups, Tags, Studios, Galleries)</p> </li> <li> <p>EmptyEntityFilterService (<code>server/services/EmptyEntityFilterService.ts</code>)</p> </li> <li>Removes \"orphaned\" entities with no visible content</li> <li>Handles complex dependency chains (Tags \u2192 Studios \u2192 Scenes)</li> <li> <p>Prevents showing empty organizational entities</p> </li> <li> <p>FilteredEntityCacheService (<code>server/services/FilteredEntityCacheService.ts</code>)</p> </li> <li>In-memory per-user cache of filtered results</li> <li>Avoids re-computing expensive filters on every request</li> <li>Invalidates on Stash cache updates or user restriction changes</li> </ol>"},{"location":"development/content-restrictions/#database-schema","title":"Database Schema","text":""},{"location":"development/content-restrictions/#usercontentrestriction-table","title":"UserContentRestriction Table","text":"<pre><code>model UserContentRestriction {\n  id            Int      @id @default(autoincrement())\n  userId        Int\n  entityType    String   // 'groups' | 'tags' | 'studios' | 'galleries'\n  mode          String   // 'INCLUDE' | 'EXCLUDE'\n  entityIds     String   // JSON array of entity IDs (stringified)\n  restrictEmpty Boolean  @default(false)  // If true, restrict items with no entities of this type\n  createdAt     DateTime @default(now())\n  updatedAt     DateTime @updatedAt\n\n  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, entityType])\n  @@index([userId])\n}\n</code></pre> <p>Important Notes: - One restriction per <code>(userId, entityType)</code> pair - <code>entityIds</code> is a JSON-stringified array of strings - <code>restrictEmpty</code> flag: if <code>true</code>, items with NO entities of this type are also excluded</p> <p>Example Records:</p> <pre><code>// User 5: Exclude Tag \"Extreme\" (ID: \"123\")\n{\n  \"userId\": 5,\n  \"entityType\": \"tags\",\n  \"mode\": \"EXCLUDE\",\n  \"entityIds\": \"[\\\"123\\\"]\",\n  \"restrictEmpty\": false\n}\n\n// User 6: INCLUDE only Studio \"Safe Studio\" (ID: \"456\")\n{\n  \"userId\": 6,\n  \"entityType\": \"studios\",\n  \"mode\": \"INCLUDE\",\n  \"entityIds\": \"[\\\"456\\\"]\",\n  \"restrictEmpty\": false\n}\n</code></pre>"},{"location":"development/content-restrictions/#how-it-works","title":"How It Works","text":""},{"location":"development/content-restrictions/#processing-order","title":"Processing Order","text":"<ol> <li>Apply INCLUDE filters (whitelist)</li> <li>If set, ONLY show entities matching ALL include filters</li> <li> <p>Acts as intersection across multiple entity types</p> </li> <li> <p>Apply EXCLUDE filters (blacklist)</p> </li> <li>Remove entities matching ANY exclude filter</li> <li> <p>Acts as difference/subtraction</p> </li> <li> <p>Apply restrictEmpty rules</p> </li> <li>Remove entities that have NO values for restricted entity type</li> </ol>"},{"location":"development/content-restrictions/#scene-filtering-example","title":"Scene Filtering Example","text":"<p>Scenario: User excludes Tag \"Extreme\" (ID: \"123\")</p> <pre><code>// UserContentRestriction record\n{\n  userId: 5,\n  entityType: \"tags\",\n  mode: \"EXCLUDE\",\n  entityIds: [\"123\"],\n  restrictEmpty: false\n}\n\n// Filtering logic\nscenes = scenes.filter(scene =&gt; {\n  const sceneTagIds = scene.tags.map(t =&gt; t.id); // [\"100\", \"123\", \"200\"]\n  const excludedIds = [\"123\"];\n  return !sceneTagIds.some(id =&gt; excludedIds.includes(id)); // FALSE - REMOVED\n});\n</code></pre> <p>Result: Any Scene with Tag \"123\" is hidden from User 5.</p>"},{"location":"development/content-restrictions/#include-vs-exclude-interaction","title":"Include vs Exclude Interaction","text":"<p>When a user has BOTH include and exclude restrictions:</p> <pre><code>// Step 1: Apply INCLUDE filters (intersection)\nfor (const includeRestriction of includeRestrictions) {\n  scenes = scenes.filter(scene =&gt; {\n    const sceneEntityIds = getSceneEntityIds(scene, includeRestriction.entityType);\n    const allowedIds = JSON.parse(includeRestriction.entityIds);\n    return sceneEntityIds.some(id =&gt; allowedIds.includes(id));\n  });\n}\n\n// Step 2: Apply EXCLUDE filters (difference)\nfor (const excludeRestriction of excludeRestrictions) {\n  scenes = scenes.filter(scene =&gt; {\n    const sceneEntityIds = getSceneEntityIds(scene, excludeRestriction.entityType);\n    const excludedIds = JSON.parse(excludeRestriction.entityIds);\n    return !sceneEntityIds.some(id =&gt; excludedIds.includes(id));\n  });\n}\n</code></pre> <p>Recommended Practice: Don't use INCLUDE mode (we warn users in GUI), as it's easy to accidentally hide everything.</p>"},{"location":"development/content-restrictions/#cascading-logic","title":"Cascading Logic","text":""},{"location":"development/content-restrictions/#current-implementation-direct-only","title":"Current Implementation (Direct Only)","text":"<p>What Works: - \u2705 Scene has excluded Tag \u2192 Scene hidden - \u2705 Scene belongs to excluded Studio \u2192 Scene hidden - \u2705 Scene in excluded Group \u2192 Scene hidden - \u2705 Gallery has excluded Tag \u2192 Gallery hidden</p> <p>What's Missing (Likely Bug Source): - \u274c Studio has excluded Tag \u2192 Studio NOT hidden (direct restriction only) - \u274c Studio has excluded Tag \u2192 Scenes from that Studio NOT hidden - \u274c Performer only in excluded Studio \u2192 Performer NOT hidden - \u274c Scene's Studio has excluded Tag \u2192 Scene NOT hidden</p>"},{"location":"development/content-restrictions/#expected-cascading-behavior","title":"Expected Cascading Behavior","text":"<p>According to user requirements, exclusions should cascade:</p> <pre><code>Tag \"Extreme\" (excluded)\n  \u2193 applied to Studio\nStudio \"Hardcore Productions\"\n  \u2193 produces\nScenes [Scene A, Scene B, Scene C]\n  \u2193 starring\nPerformers [Performer X, Performer Y]\n\nExpected Result:\n- Tag \"Extreme\" \u2192 Hidden\n- Studio \"Hardcore Productions\" \u2192 Hidden (has excluded tag)\n- Scene A, B, C \u2192 Hidden (belong to excluded studio)\n- Performer X, Y \u2192 Hidden (only appear in excluded scenes)\n</code></pre>"},{"location":"development/content-restrictions/#current-code-analysis","title":"Current Code Analysis","text":""},{"location":"development/content-restrictions/#scene-filtering-userrestrictionservicefilterscenesforuser","title":"Scene Filtering (<code>UserRestrictionService.filterScenesForUser</code>)","text":"<pre><code>private getSceneEntityIds(scene: NormalizedScene, entityType: string): string[] {\n  switch (entityType) {\n    case \"groups\":\n      return scene.groups?.map(g =&gt; String(g.id)) || [];\n    case \"tags\":\n      return scene.tags?.map(t =&gt; String(t.id)) || [];  // \u26a0\ufe0f ONLY scene.tags\n    case \"studios\":\n      return scene.studio ? [String(scene.studio.id)] : [];\n    case \"galleries\":\n      return scene.galleries?.map(g =&gt; String(g.id)) || [];\n    default:\n      return [];\n  }\n}\n</code></pre> <p>Bug #1: Scene tag filtering only checks <code>scene.tags</code>, NOT <code>scene.studio.tags</code> or <code>scene.performers[].tags</code></p> <p>Expected: <pre><code>case \"tags\":\n  const tagIds = new Set&lt;string&gt;();\n\n  // Direct scene tags\n  (scene.tags || []).forEach(t =&gt; tagIds.add(String(t.id)));\n\n  // Performer tags (cascading)\n  (scene.performers || []).forEach(p =&gt; {\n    (p.tags || []).forEach(t =&gt; tagIds.add(String(t.id)));\n  });\n\n  // Studio tags (cascading)\n  if (scene.studio?.tags) {\n    scene.studio.tags.forEach(t =&gt; tagIds.add(String(t.id)));\n  }\n\n  return Array.from(tagIds);\n</code></pre></p>"},{"location":"development/content-restrictions/#studioperformer-filtering","title":"Studio/Performer Filtering","text":"<pre><code>// Studios: Only checks if studio ID is in restricted list\nasync filterStudiosForUser(studios, userId) {\n  const studioRestriction = restrictions.find(r =&gt; r.entityType === \"studios\");\n  const restrictedIds = JSON.parse(studioRestriction.entityIds);\n\n  if (studioRestriction.mode === \"EXCLUDE\") {\n    return studios.filter(studio =&gt; !restrictedIds.includes(studio.id)); // \u26a0\ufe0f Direct only\n  }\n}\n</code></pre> <p>Bug #2: Studios are not checked for excluded Tags/Groups</p> <p>Expected: If Studio has an excluded Tag, the Studio itself should be hidden</p>"},{"location":"development/content-restrictions/#performers","title":"Performers","text":"<pre><code>async filterPerformersForUser(performers, _userId) {\n  // For now, return all performers\n  return performers;  // \u26a0\ufe0f NO FILTERING AT ALL\n}\n</code></pre> <p>Bug #3: Performers are NEVER filtered by user restrictions</p> <p>Expected: Performers should be filtered if they have excluded Tags</p>"},{"location":"development/content-restrictions/#empty-entity-filtering","title":"Empty Entity Filtering","text":"<p>After applying user restrictions, entities with no visible content are removed to prevent \"orphaned\" listings.</p>"},{"location":"development/content-restrictions/#filtering-order-dependencies","title":"Filtering Order (Dependencies)","text":"<pre><code>1. Galleries (no dependencies)\n   \u2514\u2500&gt; Keep if: image_count &gt; 0\n\n2. Groups (no dependencies, but tree traversal)\n   \u2514\u2500&gt; Keep if: scene_count &gt; 0 OR has child groups with content\n\n3. Studios (depends on: Groups, Galleries)\n   \u2514\u2500&gt; Keep if: scene_count &gt; 0 OR has visible groups OR has images OR has visible galleries\n\n4. Performers (depends on: Groups, Galleries)\n   \u2514\u2500&gt; Keep if: scene_count &gt; 0 OR image_count &gt; 0 OR in visible group OR has visible gallery\n\n5. Tags (depends on: ALL entities)\n   \u2514\u2500&gt; Keep if: attached to any visible entity OR has children with content\n</code></pre>"},{"location":"development/content-restrictions/#example-studio-empty-filtering","title":"Example: Studio Empty Filtering","text":"<pre><code>filterEmptyStudios(studios, visibleGroups, visibleGalleries) {\n  const visibleGroupIds = new Set(visibleGroups.map(g =&gt; g.id));\n  const visibleGalleryIds = new Set(visibleGalleries.map(g =&gt; g.id));\n\n  return studios.filter(studio =&gt; {\n    // Has scenes? Keep\n    if (studio.scene_count &amp;&amp; studio.scene_count &gt; 0) return true;\n\n    // Has images? Keep\n    if (studio.image_count &amp;&amp; studio.image_count &gt; 0) return true;\n\n    // Has visible groups? Keep\n    if (studio.groups?.some(g =&gt; visibleGroupIds.has(g.id))) return true;\n\n    // Has visible galleries? Keep\n    if (studio.galleries?.some(g =&gt; visibleGalleryIds.has(g.id))) return true;\n\n    // No content found\n    return false;\n  });\n}\n</code></pre> <p>Important: Empty entity filtering uses Stash's metadata counts (scene_count, image_count, etc.), which: - \u2705 Reflect Stash's view of the world - \u274c May NOT reflect user-restricted counts (if 100 scenes are all restricted, studio still shows scene_count=100)</p> <p>Potential Bug #4: Empty filtering may fail to remove entities because counts don't account for restrictions.</p> <p>Example: 1. Studio has 100 scenes 2. All 100 scenes have excluded Tag 3. Studio.scene_count = 100 (from Stash metadata) 4. Empty filter: <code>if (studio.scene_count &gt; 0)</code> \u2192 <code>true</code> \u2192 Studio NOT removed 5. User sees empty Studio in list</p>"},{"location":"development/content-restrictions/#caching-strategy","title":"Caching Strategy","text":""},{"location":"development/content-restrictions/#server-wide-cache-stashcachemanager","title":"Server-Wide Cache (StashCacheManager)","text":"<ul> <li>Scope: All entities for all users</li> <li>Storage: In-memory Map</li> <li>Refresh: Hourly + on-demand</li> <li>Invalidation: On cache refresh (version increment)</li> </ul>"},{"location":"development/content-restrictions/#per-user-filtered-cache-filteredentitycacheservice","title":"Per-User Filtered Cache (FilteredEntityCacheService)","text":"<ul> <li>Scope: Filtered entities per user</li> <li>Storage: In-memory Map with key <code>user:{userId}:{entityType}:v{cacheVersion}</code></li> <li>TTL: 1 hour</li> <li>Size Limit: 100MB total, 10MB per user</li> <li>Invalidation:</li> <li>User restrictions change \u2192 <code>invalidateUser(userId)</code></li> <li>Stash cache refresh \u2192 <code>invalidateAll()</code></li> </ul>"},{"location":"development/content-restrictions/#cache-flow","title":"Cache Flow","text":"<pre><code>Request: GET /api/library/scenes (User 5)\n  \u2193\n1. Get all scenes from StashCacheManager\n  \u2193\n2. Check FilteredEntityCacheService for user 5's filtered scenes\n  \u2193\n  \u251c\u2500 Cache HIT: Return cached filtered scenes\n  \u2502               \u2193\n  \u2502            4. Merge with fresh user data (ratings, watch history)\n  \u2502               \u2193\n  \u2502            5. Apply pagination, search, sort\n  \u2502\n  \u2514\u2500 Cache MISS:\n       \u2193\n     3a. Apply UserRestrictionService filters\n       \u2193\n     3b. Apply EmptyEntityFilterService\n       \u2193\n     3c. Store in FilteredEntityCacheService\n       \u2193\n     4. Merge with fresh user data...\n</code></pre> <p>Performance: - First request: ~500ms (compute filters) - Subsequent requests: ~50ms (cache hit) - Cache hit rate: 95%+</p>"},{"location":"development/content-restrictions/#api-endpoints","title":"API Endpoints","text":""},{"location":"development/content-restrictions/#admin-manage-user-restrictions","title":"Admin: Manage User Restrictions","text":""},{"location":"development/content-restrictions/#get-apiuseruseridrestrictions","title":"GET /api/user/:userId/restrictions","text":"<p>Auth: Admin only Response: <pre><code>{\n  \"restrictions\": [\n    {\n      \"id\": 1,\n      \"userId\": 5,\n      \"entityType\": \"tags\",\n      \"mode\": \"EXCLUDE\",\n      \"entityIds\": \"[\\\"123\\\",\\\"456\\\"]\",\n      \"restrictEmpty\": false\n    }\n  ]\n}\n</code></pre></p>"},{"location":"development/content-restrictions/#put-apiuseruseridrestrictions","title":"PUT /api/user/:userId/restrictions","text":"<p>Auth: Admin only Body: <pre><code>{\n  \"restrictions\": [\n    {\n      \"entityType\": \"tags\",\n      \"mode\": \"EXCLUDE\",\n      \"entityIds\": [\"123\", \"456\"],\n      \"restrictEmpty\": false\n    },\n    {\n      \"entityType\": \"studios\",\n      \"mode\": \"INCLUDE\",\n      \"entityIds\": [\"789\"],\n      \"restrictEmpty\": false\n    }\n  ]\n}\n</code></pre> Behavior: Replaces ALL existing restrictions for user</p>"},{"location":"development/content-restrictions/#delete-apiuseruseridrestrictions","title":"DELETE /api/user/:userId/restrictions","text":"<p>Auth: Admin only Response: <pre><code>{\n  \"success\": true,\n  \"message\": \"All content restrictions removed successfully\"\n}\n</code></pre></p>"},{"location":"development/content-restrictions/#client-library-queries","title":"Client: Library Queries","text":"<p>All library endpoints (<code>/api/library/scenes</code>, <code>/api/library/performers</code>, etc.) automatically apply: 1. User restrictions (if user is not ADMIN) 2. Empty entity filtering (if user is not ADMIN) 3. Caching (all users)</p> <p>Admins bypass restrictions and see all content.</p>"},{"location":"development/content-restrictions/#code-flow","title":"Code Flow","text":""},{"location":"development/content-restrictions/#scene-request-flow","title":"Scene Request Flow","text":"<pre><code>// server/controllers/library/scenes.ts\n\nexport const findScenes = async (req, res) =&gt; {\n  const userId = req.user.id;\n\n  // Step 1: Get ALL scenes from server-wide cache\n  let scenes = stashCacheManager.getAllScenes();\n\n  // Step 2: Determine if expensive filters needed\n  const requiresUserData = hasExpensiveFilters(filters);\n\n  if (requiresUserData) {\n    // OLD PATH: Merge user data for ALL scenes first (expensive)\n    scenes = await mergeScenesWithUserData(scenes, userId);\n    scenes = applyQuickSceneFilters(scenes, filters);\n    scenes = applyExpensiveSceneFilters(scenes, filters);\n\n    // Apply restrictions\n    if (req.user.role !== \"ADMIN\") {\n      scenes = await userRestrictionService.filterScenesForUser(scenes, userId);\n    }\n\n    scenes = sortScenes(scenes, sortField, sortDirection);\n    const paginatedScenes = scenes.slice(startIndex, endIndex);\n\n  } else {\n    // NEW OPTIMIZED PATH: Filter/sort first, merge user data only for paginated scenes\n    scenes = applyQuickSceneFilters(scenes, filters);\n\n    // Apply restrictions\n    if (req.user.role !== \"ADMIN\") {\n      scenes = await userRestrictionService.filterScenesForUser(scenes, userId);\n    }\n\n    scenes = sortScenes(scenes, sortField, sortDirection);\n    const paginatedScenes = scenes.slice(startIndex, endIndex);\n\n    // Merge user data ONLY for paginated scenes (huge performance win)\n    const scenesWithUserData = await mergeScenesWithUserData(paginatedScenes, userId);\n  }\n\n  return res.json({ scenes: scenesWithUserData });\n};\n</code></pre>"},{"location":"development/content-restrictions/#performer-request-flow","title":"Performer Request Flow","text":"<pre><code>// server/controllers/library/performers.ts\n\nexport const findPerformers = async (req, res) =&gt; {\n  const userId = req.user.id;\n  const cacheVersion = stashCacheManager.getCacheVersion();\n\n  // Step 1: Try cached filtered performers\n  let performers = filteredEntityCacheService.get(userId, \"performers\", cacheVersion);\n\n  if (performers === null) {\n    // Cache MISS: Compute filtered performers\n    performers = stashCacheManager.getAllPerformers();\n\n    // Apply user restrictions (non-admins only)\n    if (req.user.role !== \"ADMIN\") {\n      performers = await userRestrictionService.filterPerformersForUser(performers, userId);\n    }\n\n    // Filter empty performers (non-admins only)\n    if (req.user.role !== \"ADMIN\") {\n      // Get visible groups/galleries first\n      let allGalleries = stashCacheManager.getAllGalleries();\n      let allGroups = stashCacheManager.getAllGroups();\n\n      allGalleries = await userRestrictionService.filterGalleriesForUser(allGalleries, userId);\n      allGroups = await userRestrictionService.filterGroupsForUser(allGroups, userId);\n\n      const visibleGalleries = emptyEntityFilterService.filterEmptyGalleries(allGalleries);\n      const visibleGroups = emptyEntityFilterService.filterEmptyGroups(allGroups);\n\n      performers = emptyEntityFilterService.filterEmptyPerformers(\n        performers,\n        visibleGroups,\n        visibleGalleries\n      );\n    }\n\n    // Store in cache\n    filteredEntityCacheService.set(userId, \"performers\", performers, cacheVersion);\n  }\n\n  // Step 2: Merge with FRESH user data (ratings, stats)\n  performers = await mergePerformersWithUserData(performers, userId);\n\n  // Step 3: Apply filters, search, sort, paginate\n  // ...\n\n  return res.json({ performers });\n};\n</code></pre>"},{"location":"development/content-restrictions/#known-issues-edge-cases","title":"Known Issues &amp; Edge Cases","text":""},{"location":"development/content-restrictions/#fixed-bugs-january-2025","title":"Fixed Bugs (January 2025)","text":""},{"location":"development/content-restrictions/#1-fixed-empty-filtering-uses-stash-counts-not-restriction-aware","title":"1. \u2705 FIXED: Empty Filtering Uses Stash Counts (Not Restriction-Aware)","text":"<p>Original Issue: <code>scene_count</code>, <code>image_count</code> from Stash included ALL content, not user-visible content</p> <p>Example of Bug: - Studio has 100 scenes (all have excluded tag) - <code>studio.scene_count = 100</code> (from Stash) - Empty filter: <code>if (studio.scene_count &gt; 0)</code> \u2192 keeps Studio - User sees Studio with 0 visible scenes</p> <p>Root Cause: <code>EmptyEntityFilterService</code> methods (<code>filterEmptyTags</code>, <code>filterEmptyStudios</code>, <code>filterEmptyPerformers</code>) relied on Stash's metadata counts which don't account for user restrictions.</p> <p>Fix Applied: <pre><code>// BEFORE (broken)\nfilterEmptyStudios(studios, visibleGroups, visibleGalleries) {\n  return studios.filter(studio =&gt; {\n    if (studio.scene_count &amp;&amp; studio.scene_count &gt; 0) return true; // \u274c Wrong count\n    // ...\n  });\n}\n\n// AFTER (fixed)\nfilterEmptyStudios(studios, visibleGroups, visibleGalleries, visibleScenes?) {\n  // Build set of studios in visible scenes\n  const studiosInVisibleScenes = new Set&lt;string&gt;();\n  if (visibleScenes) {\n    for (const scene of visibleScenes) {\n      if (scene.studio) {\n        studiosInVisibleScenes.add(scene.studio.id);\n      }\n    }\n  }\n\n  return studios.filter(studio =&gt; {\n    // Check if studio appears in visible scenes\n    if (visibleScenes &amp;&amp; studiosInVisibleScenes.has(studio.id)) {\n      return true;\n    }\n    // Fallback to old logic if visibleScenes not provided (backward compatibility)\n    if (!visibleScenes &amp;&amp; studio.scene_count &amp;&amp; studio.scene_count &gt; 0) {\n      return true;\n    }\n    // ...\n  });\n}\n</code></pre></p> <p>Changes Made: 1. Added optional <code>visibleScenes</code> parameter to <code>filterEmptyTags</code>, <code>filterEmptyStudios</code>, <code>filterEmptyPerformers</code> 2. Methods now build Sets of entity IDs that appear in visible scenes 3. Check actual visibility instead of relying on Stash counts 4. Backward compatible - falls back to old logic if <code>visibleScenes</code> not provided</p> <p>Controllers Updated: - <code>server/controllers/library/tags.ts</code> - Filters scenes first, passes to empty filter - <code>server/controllers/library/studios.ts</code> - Filters scenes first, passes to empty filter - <code>server/controllers/library/performers.ts</code> - Filters scenes first, passes to empty filter</p> <p>Test Coverage: 5/5 integration tests passing, including: - \u2705 Studio that ONLY has content in excluded Group is hidden - \u2705 Performer that ONLY appears in excluded Group is hidden - \u2705 Tag that ONLY appears in excluded Group is hidden - \u2705 Full cascading integration test passes</p> <p>Performance Impact: +50-100ms on cache miss (minimal), 0ms on cache hit (cached results unaffected)</p> <p>Impact: CRITICAL BUG FIXED - Could expose illegal content in user's country</p>"},{"location":"development/content-restrictions/#2-fixed-broken-tag-cascade-logic","title":"2. \u2705 FIXED: Broken Tag Cascade Logic","text":"<p>Original Issue: <code>filterTagsForUser()</code> tried to check <code>tag.groups</code> and <code>tag.galleries</code> arrays which don't exist</p> <p>Root Cause: Stash tags only have count fields (<code>group_count</code>, <code>gallery_count</code>), not arrays of groups/galleries</p> <p>Fix Applied: Removed broken cascade logic (lines 259-309 in <code>UserRestrictionService.ts</code>). The correct approach is now handled by <code>EmptyEntityFilterService.filterEmptyTags()</code> which checks if tags appear on visible scenes/performers/studios.</p> <p>Impact: MEDIUM - Prevented incorrect filtering logic</p>"},{"location":"development/content-restrictions/#3-fixed-no-cascading-tag-restrictions-on-scenes","title":"3. \u2705 FIXED: No Cascading Tag Restrictions on Scenes","text":"<p>Original Issue: If Studio has excluded Tag, Scenes from that Studio were NOT hidden</p> <p>Status: Already working correctly! The <code>getSceneEntityIds()</code> method in <code>UserRestrictionService</code> implements full cascading:</p> <pre><code>case \"tags\": {\n  const tagIds = new Set&lt;string&gt;();\n\n  // Direct scene tags\n  (scene.tags || []).forEach((t: EntityWithId) =&gt; {\n    tagIds.add(String(t.id));\n  });\n\n  // Studio tags (cascading)\n  if (scene.studio?.tags) {\n    (scene.studio.tags as EntityWithId[]).forEach((t: EntityWithId) =&gt; {\n      tagIds.add(String(t.id));\n    });\n  }\n\n  // Performer tags (cascading)\n  if (scene.performers) {\n    scene.performers.forEach((performer) =&gt; {\n      if ((performer as any).tags) {\n        ((performer as any).tags as EntityWithId[]).forEach((t: EntityWithId) =&gt; {\n          tagIds.add(String(t.id));\n        });\n      }\n    });\n  }\n\n  return Array.from(tagIds);\n}\n</code></pre> <p>Verified: Integration tests confirm this works correctly</p>"},{"location":"development/content-restrictions/#edge-cases","title":"Edge Cases","text":""},{"location":"development/content-restrictions/#1-include-exclude-conflict","title":"1. Include + Exclude Conflict","text":"<p>Scenario: User has INCLUDE Studio A, but EXCLUDE Tag X. Studio A produces Scene with Tag X.</p> <p>Current Behavior: Include runs first, then Exclude removes scene \u2192 Scene hidden</p> <p>Question: Is this expected? Or should Include take precedence?</p>"},{"location":"development/content-restrictions/#2-restrictempty-flag","title":"2. restrictEmpty Flag","text":"<p>Current Use: Rarely used, purpose unclear</p> <p>Behavior: If <code>true</code>, items with NO entities of this type are also excluded</p> <p>Example: <pre><code>{\n  \"entityType\": \"tags\",\n  \"mode\": \"EXCLUDE\",\n  \"entityIds\": [\"123\"],\n  \"restrictEmpty\": true\n}\n</code></pre> Result: Exclude scenes with Tag \"123\" AND scenes with NO tags at all</p> <p>Question: Is this feature needed? If not, should be removed to reduce complexity.</p>"},{"location":"development/content-restrictions/#3-circular-group-hierarchies","title":"3. Circular Group Hierarchies","text":"<p>Scenario: Group A is child of Group B, Group B is child of Group A</p> <p>Current Behavior: <code>checkHasContent()</code> uses <code>visited</code> Set to prevent infinite loops</p> <p>Status: HANDLED \u2705</p>"},{"location":"development/content-restrictions/#4-tag-dag-complexity","title":"4. Tag DAG Complexity","text":"<p>Scenario: Tags form directed acyclic graph with multiple parents</p> <p>Current Behavior: Tag kept if ANY child has content (OR logic)</p> <p>Question: Is this correct? Or should ALL parents be required (AND logic)?</p>"},{"location":"development/content-restrictions/#testing-strategy","title":"Testing Strategy","text":""},{"location":"development/content-restrictions/#unit-tests-needed","title":"Unit Tests Needed","text":""},{"location":"development/content-restrictions/#1-userrestrictionservice","title":"1. UserRestrictionService","text":"<pre><code>describe('UserRestrictionService', () =&gt; {\n  describe('filterScenesForUser', () =&gt; {\n    it('should exclude scenes with excluded tags', () =&gt; {});\n    it('should exclude scenes from excluded studios', () =&gt; {});\n    it('should exclude scenes in excluded groups', () =&gt; {});\n    it('should cascade: exclude scenes if studio has excluded tag', () =&gt; {});\n    it('should cascade: exclude scenes if performer has excluded tag', () =&gt; {});\n    it('should apply INCLUDE filters first', () =&gt; {});\n    it('should apply EXCLUDE filters after INCLUDE', () =&gt; {});\n    it('should respect restrictEmpty flag', () =&gt; {});\n    it('should return all scenes for admin users', () =&gt; {});\n  });\n\n  describe('filterStudiosForUser', () =&gt; {\n    it('should exclude studios with excluded studio IDs', () =&gt; {});\n    it('should CASCADE: exclude studios with excluded tags', () =&gt; {});  // BUG\n    it('should CASCADE: exclude studios with excluded groups', () =&gt; {});  // BUG\n    it('should apply INCLUDE mode correctly', () =&gt; {});\n  });\n\n  describe('filterPerformersForUser', () =&gt; {\n    it('should exclude performers with excluded tags', () =&gt; {});  // BUG (currently returns all)\n    it('should apply INCLUDE mode correctly', () =&gt; {});\n  });\n\n  describe('filterTagsForUser', () =&gt; {\n    it('should exclude tags by ID', () =&gt; {});\n    it('should apply INCLUDE mode correctly', () =&gt; {});\n  });\n});\n</code></pre>"},{"location":"development/content-restrictions/#2-emptyentityfilterservice","title":"2. EmptyEntityFilterService","text":"<pre><code>describe('EmptyEntityFilterService', () =&gt; {\n  describe('filterEmptyGalleries', () =&gt; {\n    it('should remove galleries with no images', () =&gt; {});\n    it('should keep galleries with images', () =&gt; {});\n  });\n\n  describe('filterEmptyGroups', () =&gt; {\n    it('should remove groups with no scenes', () =&gt; {});\n    it('should keep groups with scenes', () =&gt; {});\n    it('should keep parent groups if child has scenes', () =&gt; {});\n    it('should handle circular group hierarchies', () =&gt; {});\n  });\n\n  describe('filterEmptyStudios', () =&gt; {\n    it('should remove studios with no scenes and no groups', () =&gt; {});\n    it('should keep studios with scenes', () =&gt; {});\n    it('should keep studios with visible groups', () =&gt; {});\n    it('should keep studios with visible galleries', () =&gt; {});\n    it('should use restriction-aware counts', () =&gt; {});  // BUG\n  });\n\n  describe('filterEmptyPerformers', () =&gt; {\n    it('should remove performers with no scenes and no images', () =&gt; {});\n    it('should keep performers with scenes', () =&gt; {});\n    it('should keep performers in visible groups', () =&gt; {});\n    it('should keep performers with visible galleries', () =&gt; {});\n  });\n\n  describe('filterEmptyTags', () =&gt; {\n    it('should remove tags not attached to any entities', () =&gt; {});\n    it('should keep tags with scenes', () =&gt; {});\n    it('should keep tags with images', () =&gt; {});\n    it('should keep parent tags if child has content', () =&gt; {});\n    it('should handle complex tag DAG', () =&gt; {});\n  });\n});\n</code></pre>"},{"location":"development/content-restrictions/#3-integration-tests","title":"3. Integration Tests","text":"<pre><code>describe('Content Restrictions Integration', () =&gt; {\n  it('should cascade: Tag \u2192 Studio \u2192 Scene \u2192 Performer', async () =&gt; {\n    // Setup:\n    // - Tag \"Extreme\" applied to Studio \"XYZ\"\n    // - Studio \"XYZ\" produces Scene A\n    // - Performer \"John\" only in Scene A\n    // - User excludes Tag \"Extreme\"\n\n    // Expected:\n    // - Tag \"Extreme\" hidden\n    // - Studio \"XYZ\" hidden\n    // - Scene A hidden\n    // - Performer \"John\" hidden (only in excluded scene)\n  });\n\n  it('should handle INCLUDE + EXCLUDE interaction', async () =&gt; {\n    // User INCLUDEs Studio A, EXCLUDEs Tag X\n    // Scene from Studio A has Tag X\n    // Expected: Scene hidden (exclude takes precedence after include)\n  });\n\n  it('should not filter admin users', async () =&gt; {});\n\n  it('should invalidate cache when restrictions change', async () =&gt; {});\n});\n</code></pre>"},{"location":"development/content-restrictions/#manual-test-scenarios","title":"Manual Test Scenarios","text":""},{"location":"development/content-restrictions/#scenario-1-basic-tag-exclusion","title":"Scenario 1: Basic Tag Exclusion","text":"<ol> <li>Admin creates restriction: User 5 excludes Tag \"Extreme\"</li> <li>Login as User 5</li> <li>Verify:</li> <li>\u274c Tag \"Extreme\" not in tag list</li> <li>\u274c Scenes with Tag \"Extreme\" not in scene list</li> <li>\u274c Studios that ONLY produce \"Extreme\" tagged content are hidden</li> <li>\u274c Performers that ONLY appear in \"Extreme\" scenes are hidden</li> </ol>"},{"location":"development/content-restrictions/#scenario-2-cascading-tag-exclusion","title":"Scenario 2: Cascading Tag Exclusion","text":"<ol> <li>Admin creates restriction: User 5 excludes Tag \"Extreme\"</li> <li>Tag \"Extreme\" is applied to Studio \"XYZ Productions\"</li> <li>Login as User 5</li> <li>Verify:</li> <li>\u274c Studio \"XYZ Productions\" is hidden</li> <li>\u274c ALL scenes from \"XYZ Productions\" are hidden</li> <li>\u274c Performers only in \"XYZ Productions\" scenes are hidden</li> </ol>"},{"location":"development/content-restrictions/#scenario-3-group-exclusion-with-cascading-fixed","title":"Scenario 3: Group Exclusion with Cascading \u2705 FIXED","text":"<ol> <li>Admin creates restriction: User 5 excludes Group \"Extreme Collection\"</li> <li>Studio \"ABC\" produces scenes in \"Extreme Collection\"</li> <li>Login as User 5</li> <li>Verify:</li> <li>\u2705 Group \"Extreme Collection\" not in group list</li> <li>\u2705 Scenes in \"Extreme Collection\" not in scene list</li> <li>\u2705 Studio \"ABC\" is hidden if ALL its scenes are in excluded group</li> </ol>"},{"location":"development/content-restrictions/#scenario-4-empty-studio-after-restriction-fixed","title":"Scenario 4: Empty Studio After Restriction \u2705 FIXED","text":"<ol> <li>Studio \"XYZ\" has 10 scenes</li> <li>ALL 10 scenes have Tag \"Extreme\"</li> <li>User 5 excludes Tag \"Extreme\"</li> <li>Verify:</li> <li>\u2705 Studio \"XYZ\" is NOT shown (all scenes hidden, studio is now \"empty\")</li> </ol>"},{"location":"development/content-restrictions/#summary","title":"Summary","text":""},{"location":"development/content-restrictions/#what-works-january-2025","title":"What Works (January 2025)","text":"<ul> <li>\u2705 Direct exclusions (Scene has Tag \u2192 Scene hidden)</li> <li>\u2705 INCLUDE/EXCLUDE modes</li> <li>\u2705 restrictEmpty flag</li> <li>\u2705 Caching for performance</li> <li>\u2705 FIXED: Empty entity filtering now checks actual visibility</li> <li>\u2705 FIXED: Tags, Studios, Performers that only exist in excluded content are hidden</li> <li>\u2705 Admin bypass</li> <li>\u2705 Tag cascading (Tag \u2192 Studio \u2192 Scene) - was already working</li> <li>\u2705 Tag cascading (Tag \u2192 Performer \u2192 Scene) - was already working</li> <li>\u2705 Group cascading (Group \u2192 Scene \u2192 Studio/Performer/Tag hidden if no other content)</li> </ul>"},{"location":"development/content-restrictions/#test-coverage","title":"Test Coverage","text":"<ul> <li>\u2705 315/315 tests passing</li> <li>\u2705 Comprehensive TDD integration tests in <code>server/services/__tests__/UserRestrictionService.integration.test.ts</code></li> <li>\u2705 Real-world \"Bestiality\" Group exclusion scenario tested</li> <li>\u2705 Full cascading verified:</li> <li>Scene filtering</li> <li>Studio filtering (studios with no visible scenes hidden)</li> <li>Performer filtering (performers with no visible scenes hidden)</li> <li>Tag filtering (tags with no visible content hidden)</li> </ul>"},{"location":"development/content-restrictions/#known-limitations","title":"Known Limitations","text":"<ul> <li>Performer direct restrictions not implemented (only cascade filtering works)</li> <li><code>restrictEmpty</code> flag edge cases not fully tested</li> </ul>"},{"location":"development/content-restrictions/#next-steps","title":"Next Steps","text":"<ol> <li>Monitor production for any edge cases</li> <li>Add more comprehensive unit tests for individual services</li> <li>Consider implementing direct performer restrictions if needed</li> <li>Document performance characteristics with large datasets</li> </ol> <p>Document Version: 2.0 Last Updated: 2025-01-20 Author: Claude Code</p>"},{"location":"development/regression-testing/","title":"Regression Testing Guide","text":"<p>This guide provides comprehensive regression testing procedures for Peek Stash Browser. Use this checklist before releasing new versions to ensure core functionality remains stable.</p> <p>Report Inaccuracies</p> <p>If you find any errors, outdated information, or inaccurate testing steps in this document, please report them via GitHub Issues with the label <code>documentation</code>. This helps keep the testing guide accurate and useful for everyone.</p>"},{"location":"development/regression-testing/#testing-environment-setup","title":"Testing Environment Setup","text":"<p>Before beginning regression testing:</p> <ol> <li>Test Data: Ensure your Stash library has:</li> <li>Multiple scenes with various file formats (MP4, MKV, etc.)</li> <li>Scenes with different durations (short &lt;5min, medium 5-30min, long &gt;30min)</li> <li>Multiple performers, studios, tags</li> <li>At least one gallery and one group/movie</li> <li>Network Conditions: Test on stable network connection</li> <li>Browsers: Test on at least two browsers (Chrome/Edge and Firefox recommended)</li> <li>Clean State: Clear browser cache and cookies before testing critical flows</li> </ol>"},{"location":"development/regression-testing/#test-execution-guidelines","title":"Test Execution Guidelines","text":"<ul> <li>Mark Pass/Fail: Check off tests as you complete them</li> <li>Document Failures: Note version, browser, and steps to reproduce any failures</li> <li>Severity Levels:</li> <li>Critical: Blocks core functionality (video playback, login, etc.)</li> <li>High: Major feature broken (search, playlists, filtering)</li> <li>Medium: Feature degraded but usable</li> <li>Low: Minor UI/UX issue</li> </ul>"},{"location":"development/regression-testing/#core-feature-tests","title":"Core Feature Tests","text":""},{"location":"development/regression-testing/#1-authentication-user-management","title":"1. Authentication &amp; User Management","text":""},{"location":"development/regression-testing/#11-first-time-setup","title":"1.1 First-Time Setup","text":"<p>Precondition: Fresh installation with no existing database</p> <ul> <li> Setup wizard appears on first access</li> <li> Can configure path mappings successfully</li> <li> Path mappings are validated (invalid paths show error)</li> <li> Default admin user is created</li> <li> After setup, redirects to login page</li> </ul>"},{"location":"development/regression-testing/#12-login-flow","title":"1.2 Login Flow","text":"<ul> <li> Can log in with valid credentials</li> <li> Invalid credentials show error message</li> <li> Session persists after page refresh</li> <li> JWT token expires after 24 hours (requires waiting or manual token expiry)</li> <li> Expired token redirects to login page</li> </ul>"},{"location":"development/regression-testing/#13-user-preferences","title":"1.3 User Preferences","text":"<p>Precondition: Logged in as any user</p> <ul> <li> Settings page loads without errors</li> <li> Can change default video quality (auto, 1080p, 720p, 480p, 360p)</li> <li> Can change playback mode (auto, direct, transcode)</li> <li> Can change theme (multiple built-in themes available)</li> <li> Can change preview quality (sprite, webp, mp4)</li> <li> Can change minimum play percent (0-100% slider)</li> <li> Preferences persist after logout/login</li> <li> Preferences apply immediately (theme change, etc.)</li> </ul>"},{"location":"development/regression-testing/#14-user-management-admin-only","title":"1.4 User Management (Admin Only)","text":"<p>Precondition: Logged in as admin user</p> <ul> <li> Can view list of all users</li> <li> Can create new user (Admin or User role)</li> <li> Can delete non-admin users</li> <li> Cannot delete own admin account</li> <li> Can change user passwords</li> <li> Can toggle user roles (Admin \u2194 User)</li> </ul>"},{"location":"development/regression-testing/#2-video-playback","title":"2. Video Playback","text":""},{"location":"development/regression-testing/#21-direct-playback-no-transcoding","title":"2.1 Direct Playback (No Transcoding)","text":"<p>Precondition: Select quality \"Direct\" in video player</p> <ul> <li> Video starts playing within 3 seconds</li> <li> Playback is smooth (no stuttering)</li> <li> Audio syncs with video</li> <li> Can pause and resume</li> <li> Can seek to different timestamps (beginning, middle, end)</li> <li> Volume control works</li> <li> Fullscreen toggle works</li> <li> Player shows correct duration</li> <li> Timeline/scrubber reflects current position</li> </ul>"},{"location":"development/regression-testing/#22-transcoded-playback-hls","title":"2.2 Transcoded Playback (HLS)","text":"<p>Precondition: Select quality \"720p\" or lower in video player</p> <ul> <li> HLS stream starts within 5 seconds</li> <li> Quality selector shows available qualities (360p, 480p, 720p, 1080p)</li> <li> Can switch between qualities mid-playback</li> <li> Playback resumes at same position after quality change</li> <li> Seeking works correctly (forward and backward)</li> <li> Far seeks (&gt;2 minutes ahead) restart transcoding session properly</li> <li> Segments load progressively (check Network tab)</li> <li> No missing segments or 404 errors</li> <li> Transcoding session cleans up after 90 seconds of inactivity</li> </ul> <p>Test Scenarios:</p> <ul> <li> Short video (&lt;5min): Plays from start to finish without errors</li> <li> Long video (&gt;30min): Can seek to middle and end without issues</li> <li> Multiple quality switches: Switch between 360p \u2192 720p \u2192 480p during playback</li> <li> Rapid seeking: Seek multiple times in quick succession (shouldn't crash)</li> </ul>"},{"location":"development/regression-testing/#23-resume-playback","title":"2.3 Resume Playback","text":"<p>Precondition: Previously watched a scene partially (not to completion)</p> <ul> <li> Scene shows resume position indicator (progress bar on thumbnail)</li> <li> Clicking scene shows \"Resume\" and \"Restart\" options</li> <li> \"Resume\" starts playback at last position (within 5 seconds accuracy)</li> <li> \"Restart\" starts playback at 0:00</li> <li> Resume position updates as video plays</li> <li> Watching to completion clears resume position</li> </ul>"},{"location":"development/regression-testing/#24-watch-history-tracking","title":"2.4 Watch History Tracking","text":"<ul> <li> Play count increments after watching</li> <li> Play duration accumulates correctly</li> <li> O-counter increments when marking scenes</li> <li> Last played timestamp updates</li> <li> Watch history appears in \"Recently Watched\" carousel (if implemented)</li> <li> Watch history persists across sessions</li> </ul>"},{"location":"development/regression-testing/#3-scene-search-filtering-and-sorting","title":"3. Scene Search, Filtering, and Sorting","text":""},{"location":"development/regression-testing/#31-search-functionality","title":"3.1 Search Functionality","text":"<p>Location: Scenes page, search bar at top</p> <ul> <li> Typing in search bar shows results in real-time</li> <li> Search matches scene titles</li> <li> Search matches performer names</li> <li> Search matches studio names</li> <li> Search matches tag names</li> <li> Empty search shows all scenes</li> <li> Search results update immediately (&lt;500ms)</li> <li> Clearing search resets to full library</li> </ul>"},{"location":"development/regression-testing/#32-filtering","title":"3.2 Filtering","text":"<p>Location: Scenes page, filter panel (sidebar or modal)</p>"},{"location":"development/regression-testing/#basic-filters","title":"Basic Filters","text":"<ul> <li> Filter by performer (single selection)</li> <li> Filter by multiple performers (AND logic)</li> <li> Filter by studio (single selection)</li> <li> Filter by tag (single selection)</li> <li> Filter by multiple tags (AND/OR logic based on settings)</li> <li> Filter by rating (min/max range)</li> <li> Filter by organized status (Yes/No/All)</li> <li> Filter by O-counter value (min/max range)</li> </ul>"},{"location":"development/regression-testing/#advanced-filters","title":"Advanced Filters","text":"<ul> <li> Filter by duration (min/max range in minutes)</li> <li> Filter by resolution (SD/HD/4K/etc.)</li> <li> Filter by interactive (Yes/No if applicable)</li> <li> Combining multiple filters applies AND logic correctly</li> <li> Clearing filters resets to full library</li> </ul>"},{"location":"development/regression-testing/#filter-presets","title":"Filter Presets","text":"<ul> <li> Can save current filter state as preset</li> <li> Can load saved filter preset</li> <li> Can delete saved filter preset</li> <li> Presets persist across sessions</li> <li> Default presets load on page visit (if configured)</li> </ul>"},{"location":"development/regression-testing/#hidden-items-filter","title":"Hidden Items Filter","text":"<ul> <li> Filter shows \"Show Hidden Items\" toggle</li> <li> Hidden scenes are excluded by default</li> <li> Toggling \"Show Hidden Items\" reveals hidden scenes</li> <li> Hidden scenes display with visual indicator (dimmed, badge, etc.)</li> </ul>"},{"location":"development/regression-testing/#33-sorting","title":"3.3 Sorting","text":"<p>Location: Scenes page, sort dropdown</p> <ul> <li> Sort by Date Added (newest first)</li> <li> Sort by Date Added (oldest first)</li> <li> Sort by Title (A-Z)</li> <li> Sort by Title (Z-A)</li> <li> Sort by Duration (longest first)</li> <li> Sort by Duration (shortest first)</li> <li> Sort by Rating (highest first)</li> <li> Sort by Rating (lowest first)</li> <li> Sort by Play Count (most played first)</li> <li> Sort by Random (different order on each load)</li> <li> Sort order persists when navigating away and back</li> <li> Sort works correctly with active filters</li> </ul>"},{"location":"development/regression-testing/#34-paginationinfinite-scroll","title":"3.4 Pagination/Infinite Scroll","text":"<p>Precondition: Library has &gt;40 scenes (default page size)</p> <ul> <li> Initial page loads first 40 scenes</li> <li> Scrolling to bottom loads next page automatically</li> <li> Loading indicator appears while fetching</li> <li> No duplicate scenes appear</li> <li> Can scroll through entire library without errors</li> <li> Scroll position maintained when navigating back from scene details</li> </ul>"},{"location":"development/regression-testing/#4-scene-grid-and-preview-playback","title":"4. Scene Grid and Preview Playback","text":""},{"location":"development/regression-testing/#41-scene-cards-display","title":"4.1 Scene Cards Display","text":"<ul> <li> Scene thumbnails load correctly</li> <li> Scene titles display correctly</li> <li> Scene metadata visible (duration, rating, date, etc.)</li> <li> Performer names display (truncated if too many)</li> <li> Studio name displays (if applicable)</li> <li> Watch history indicators show (resume bar, play count, O-counter)</li> <li> Cards have hover effects (preview, actions, etc.)</li> </ul>"},{"location":"development/regression-testing/#42-preview-playback-on-hover","title":"4.2 Preview Playback on Hover","text":"<p>Precondition: Preview feature enabled in settings</p> <ul> <li> Hovering over scene card for 2 seconds starts preview</li> <li> Preview plays short clip from scene</li> <li> Preview has no audio (or low volume)</li> <li> Preview loops continuously while hovering</li> <li> Moving mouse away stops preview immediately</li> <li> Preview quality matches user preference (Low/Medium/High)</li> <li> Preview doesn't interfere with clicking/navigation</li> <li> Multiple rapid hovers don't cause errors</li> </ul>"},{"location":"development/regression-testing/#43-scene-card-actions","title":"4.3 Scene Card Actions","text":"<p>Location: Hover over scene card or three-dot menu</p> <ul> <li> Can play scene directly (navigates to player page)</li> <li> Can add scene to playlist (opens playlist selector)</li> <li> Can mark scene as watched</li> <li> Can mark O-counter increment</li> <li> Can rate scene (opens rating modal or inline rating)</li> <li> Can hide scene (requires confirmation, scene disappears)</li> <li> Can view scene details (navigates to details page)</li> <li> Can download original file (triggers download)</li> </ul>"},{"location":"development/regression-testing/#5-playlists","title":"5. Playlists","text":""},{"location":"development/regression-testing/#51-playlist-creation","title":"5.1 Playlist Creation","text":"<p>Location: Playlists page or scene card menu</p> <ul> <li> Can create new playlist with name</li> <li> Can create new playlist with description (optional)</li> <li> Empty playlists are allowed</li> <li> Duplicate playlist names are allowed (or prevented based on requirements)</li> <li> New playlist appears in playlists list immediately</li> </ul>"},{"location":"development/regression-testing/#52-addingremoving-scenes","title":"5.2 Adding/Removing Scenes","text":"<ul> <li> Can add scene to playlist from scene card menu</li> <li> Can add multiple scenes to playlist in batch</li> <li> Can remove scene from playlist (via playlist view)</li> <li> Can reorder scenes in playlist (drag-and-drop or up/down buttons)</li> <li> Playlist item count updates immediately</li> <li> Playlist thumbnail updates to first scene</li> </ul>"},{"location":"development/regression-testing/#53-playlist-playback","title":"5.3 Playlist Playback","text":"<p>Precondition: Playlist has at least 3 scenes</p> <ul> <li> Clicking playlist plays first scene</li> <li> Auto-advances to next scene after current finishes</li> <li> \"Previous\" button goes to previous scene</li> <li> \"Next\" button goes to next scene</li> <li> Playlist progress indicator shows (e.g., \"2 of 5\")</li> <li> Can exit playlist playback and return later (resumes at last scene)</li> <li> Shuffle mode randomizes playback order</li> <li> Repeat mode restarts playlist after last scene</li> <li> Shuffle + Repeat combination works correctly</li> </ul>"},{"location":"development/regression-testing/#54-playlist-management","title":"5.4 Playlist Management","text":"<ul> <li> Can rename playlist</li> <li> Can edit playlist description</li> <li> Can delete playlist (requires confirmation)</li> <li> Deleting playlist doesn't delete scenes</li> <li> Can duplicate playlist</li> <li> Can export playlist as M3U (downloads file with relative paths)</li> <li> Can clear all scenes from playlist</li> </ul>"},{"location":"development/regression-testing/#6-performers-studios-tags-galleries-groups","title":"6. Performers, Studios, Tags, Galleries, Groups","text":""},{"location":"development/regression-testing/#61-performers-page","title":"6.1 Performers Page","text":"<ul> <li> Performers grid loads with thumbnails</li> <li> Can search performers by name</li> <li> Can filter performers by tag (if applicable)</li> <li> Can sort performers (name, scene count, etc.)</li> <li> Clicking performer navigates to performer details</li> <li> Performer details show bio, image, scene count</li> <li> Performer details show list of scenes</li> <li> Can filter scenes on performer page (same filters as main scenes page)</li> <li> Can rate performer (if rating feature exists)</li> <li> Can mark performer as favorite</li> </ul>"},{"location":"development/regression-testing/#62-studios-page","title":"6.2 Studios Page","text":"<ul> <li> Studios grid loads with logos/thumbnails</li> <li> Can search studios by name</li> <li> Can sort studios (name, scene count, etc.)</li> <li> Clicking studio navigates to studio details</li> <li> Studio details show scene count and scene list</li> <li> Can filter scenes on studio page</li> <li> Can rate studio (if rating feature exists)</li> <li> Can mark studio as favorite</li> </ul>"},{"location":"development/regression-testing/#63-tags-page","title":"6.3 Tags Page","text":"<ul> <li> Tags list loads (grid or list view)</li> <li> Can search tags by name</li> <li> Can sort tags (name, scene count, etc.)</li> <li> Clicking tag navigates to tag details or filters scenes</li> <li> Tag details show scene count and scene list</li> <li> Can filter scenes by tag combinations (multiple tags)</li> <li> Can hide/show tag categories (if hierarchical)</li> </ul>"},{"location":"development/regression-testing/#64-galleries-page","title":"6.4 Galleries Page","text":"<ul> <li> Galleries grid loads with cover images</li> <li> Can search galleries by title</li> <li> Can filter galleries by performer/studio/tag</li> <li> Clicking gallery navigates to gallery viewer</li> <li> Gallery viewer shows all images in grid or slideshow</li> <li> Can navigate images with arrow keys or swipe</li> <li> Can zoom images</li> <li> Can download images</li> <li> Can rate gallery (if rating feature exists)</li> </ul>"},{"location":"development/regression-testing/#65-groupsmovies-page","title":"6.5 Groups/Movies Page","text":"<ul> <li> Groups grid loads with cover images</li> <li> Can search groups by name</li> <li> Can filter groups by studio/performer/tag</li> <li> Clicking group navigates to group details</li> <li> Group details show scene list in correct order</li> <li> Can play group as playlist (scenes in order)</li> <li> Can reorder scenes in group (if editing is allowed)</li> </ul>"},{"location":"development/regression-testing/#7-ratings-and-favorites","title":"7. Ratings and Favorites","text":""},{"location":"development/regression-testing/#71-rating-scenes","title":"7.1 Rating Scenes","text":"<ul> <li> Can rate scene from 0-100 (or 0-5 stars)</li> <li> Rating updates immediately on scene card</li> <li> Rating persists across sessions</li> <li> Can change rating multiple times</li> <li> Can clear rating (set to null/unrated)</li> <li> Average rating shown alongside user rating (if Stash has community ratings)</li> </ul>"},{"location":"development/regression-testing/#72-favorite-scenes","title":"7.2 Favorite Scenes","text":"<ul> <li> Can mark scene as favorite (heart icon)</li> <li> Favorite status toggles on/off</li> <li> Favorite indicator visible on scene card</li> <li> Can filter scenes to show only favorites</li> <li> Favorites persist across sessions</li> </ul>"},{"location":"development/regression-testing/#73-rating-other-entities","title":"7.3 Rating Other Entities","text":"<p>Test for Performers, Studios, Tags, Galleries, Groups:</p> <ul> <li> Can rate each entity type</li> <li> Can favorite each entity type</li> <li> Ratings and favorites persist</li> <li> Can filter by rating/favorite status</li> </ul>"},{"location":"development/regression-testing/#8-user-settings-and-preferences","title":"8. User Settings and Preferences","text":""},{"location":"development/regression-testing/#81-general-settings","title":"8.1 General Settings","text":"<p>Location: Settings page \u2192 General Settings section</p> <ul> <li> Can change default video quality (auto, 1080p, 720p, 480p, 360p)</li> <li> Can change playback mode (auto, direct, transcode)</li> <li> Can change theme (multiple built-in themes available)</li> <li> Can change preview quality (sprite, webp, mp4)</li> <li> Can toggle preview autoplay on hover (On/Off)</li> <li> Can change minimum play percent (0-100% slider)</li> <li> Can change default sort order for scenes</li> <li> Can change scenes per page (if configurable)</li> <li> Settings save immediately or on \"Save\" button click</li> <li> Settings apply immediately (no page refresh required for most)</li> </ul>"},{"location":"development/regression-testing/#82-carousel-preferences","title":"8.2 Carousel Preferences","text":"<p>Location: Settings page \u2192 Carousel Settings section</p> <ul> <li> Can toggle carousels on/off (Recently Watched, Top Rated, etc.)</li> <li> Can reorder carousels (drag-and-drop or up/down buttons)</li> <li> Can configure number of items per carousel</li> <li> Changes reflect immediately on home page</li> </ul>"},{"location":"development/regression-testing/#83-navigation-preferences","title":"8.3 Navigation Preferences","text":"<p>Location: Settings page \u2192 Navigation Settings section</p> <ul> <li> Can toggle sidebar visibility (always visible, collapsible, hidden)</li> <li> Can toggle top bar elements (show/hide search, user menu, etc.)</li> <li> Can configure keyboard shortcuts (if customizable)</li> </ul>"},{"location":"development/regression-testing/#84-filter-presets","title":"8.4 Filter Presets","text":"<p>Location: Settings page \u2192 Filter Presets section</p> <ul> <li> Can view saved filter presets</li> <li> Can edit filter preset name/description</li> <li> Can delete filter preset</li> <li> Can set default filter preset (auto-loads on scenes page)</li> <li> Can export/import filter presets (JSON file)</li> </ul>"},{"location":"development/regression-testing/#85-hidden-items-user-feature","title":"8.5 Hidden Items (User Feature)","text":"<p>Location: Settings page \u2192 link to Hidden Items page</p> <ul> <li> Can hide individual scenes, performers, studios, tags, galleries, groups</li> <li> Hidden items link in Settings navigates to Hidden Items page</li> <li> Hidden Items page shows all hidden entities grouped by type</li> <li> Can unhide items from Hidden Items page</li> <li> \"Show Hidden Items\" toggle on filter panels reveals hidden content</li> <li> Hidden items persist across sessions</li> </ul>"},{"location":"development/regression-testing/#86-content-restrictions-admin-feature","title":"8.6 Content Restrictions (Admin Feature)","text":"<p>Location: User Management page \u2192 Content Restrictions modal (admin only)</p> <p>Note: This is an admin-only feature for managing per-user content restrictions, separate from user-level hidden items.</p> <ul> <li> Admin can access Content Restrictions modal from User Management</li> <li> Can set INCLUDE mode (user sees only specified groups/tags/studios/galleries)</li> <li> Can set EXCLUDE mode (user doesn't see specified groups/tags/studios/galleries)</li> <li> Can select multiple groups, tags, studios, galleries for restriction</li> <li> Restrictions apply only to the selected user</li> <li> Restrictions apply immediately across all pages for that user</li> <li> Restrictions persist across sessions</li> <li> Can clear all restrictions for a user</li> </ul>"},{"location":"development/regression-testing/#9-keyboard-navigation-and-shortcuts","title":"9. Keyboard Navigation and Shortcuts","text":""},{"location":"development/regression-testing/#91-global-shortcuts","title":"9.1 Global Shortcuts","text":"<p>Precondition: Focus on main application (not in text input)</p> <ul> <li> <code>Space</code> or <code>K</code> pauses/plays video (in player)</li> <li> <code>F</code> toggles fullscreen (in player)</li> <li> <code>M</code> toggles mute (in player)</li> <li> <code>Left/Right</code> arrow keys seek video (\u00b15 seconds)</li> <li> <code>Up/Down</code> arrow keys adjust volume (\u00b15%)</li> <li> <code>J/L</code> keys seek video (\u00b110 seconds)</li> <li> <code>Home/End</code> keys jump to start/end of video</li> <li> <code>Shift+&gt;/Shift+&lt;</code> adjust playback speed</li> <li> <code>Shift+N/Shift+P</code> next/previous scene in playlist</li> <li> Media hardware keys (Play/Pause, FastForward, Rewind, TrackNext, TrackPrevious)</li> <li> <code>0-9</code> seek to percentage (1 = 10%, 5 = 50%, etc.)</li> <li> <code>Esc</code> exits fullscreen or closes modals</li> <li> <code>/</code> focuses search bar</li> <li> <code>?</code> opens keyboard shortcuts help modal (if implemented)</li> </ul>"},{"location":"development/regression-testing/#92-scene-grid-navigation","title":"9.2 Scene Grid Navigation","text":"<p>Precondition: Focus on scenes grid (not in search/filter)</p> <ul> <li> Arrow keys navigate between scene cards</li> <li> <code>Enter</code> plays selected scene</li> <li> <code>A</code> adds selected scene to playlist</li> <li> <code>H</code> hides selected scene</li> <li> <code>R</code> opens rating modal for selected scene</li> <li> Tab/Shift+Tab navigates focusable elements</li> </ul>"},{"location":"development/regression-testing/#93-tv-mode-navigation","title":"9.3 TV Mode Navigation","text":"<p>Precondition: TV Mode enabled (if applicable)</p> <ul> <li> D-pad navigation works (arrow keys simulate remote)</li> <li> Enter/Select button activates items</li> <li> Back button exits player or modals</li> <li> Focus indicators are clearly visible</li> <li> No keyboard traps (can always navigate out)</li> </ul>"},{"location":"development/regression-testing/#10-server-settings-and-admin-features","title":"10. Server Settings and Admin Features","text":""},{"location":"development/regression-testing/#101-server-information","title":"10.1 Server Information","text":"<p>Precondition: Logged in as admin</p> <p>Location: Settings page \u2192 Server tab</p> <ul> <li> Server version displayed correctly (matches package.json)</li> <li> Stash server URL displayed</li> <li> Stash server version displayed (fetched from Stash API)</li> <li> Database location displayed</li> <li> Cache directory location displayed</li> <li> Uptime displayed (time since server start)</li> </ul>"},{"location":"development/regression-testing/#102-cache-management","title":"10.2 Cache Management","text":"<p>Location: Settings page \u2192 Server tab \u2192 Cache section</p> <ul> <li> Can view cache status (last refresh time, entity counts)</li> <li> Can manually refresh cache (button triggers refresh)</li> <li> Cache refresh shows progress indicator</li> <li> Cache refresh completes without errors</li> <li> Scene count updates after cache refresh</li> <li> New scenes from Stash appear after cache refresh</li> </ul>"},{"location":"development/regression-testing/#103-path-mappings","title":"10.3 Path Mappings","text":"<p>Location: Settings page \u2192 Server tab \u2192 Path Mappings section</p> <ul> <li> Can view existing path mappings (Stash path \u2192 Peek path)</li> <li> Can add new path mapping</li> <li> Can edit existing path mapping</li> <li> Can delete path mapping (requires confirmation)</li> <li> Invalid paths show validation error</li> <li> Path mappings apply immediately (no restart required)</li> <li> Test path translation feature works (if exists)</li> </ul>"},{"location":"development/regression-testing/#104-update-checker","title":"10.4 Update Checker","text":"<p>Location: Settings page \u2192 Server tab \u2192 Updates section</p> <ul> <li> Current version displayed</li> <li> \"Check for updates\" button queries GitHub API</li> <li> If update available, shows banner with version number and changelog link</li> <li> If no update, shows \"Up to date\" message</li> <li> Clicking changelog link opens GitHub release page in new tab</li> </ul>"},{"location":"development/regression-testing/#11-error-handling-and-edge-cases","title":"11. Error Handling and Edge Cases","text":""},{"location":"development/regression-testing/#111-network-errors","title":"11.1 Network Errors","text":"<p>Test Scenarios:</p> <ul> <li> Stash server offline: App shows error message, doesn't crash</li> <li> Stash server slow: Loading indicators appear, requests timeout gracefully</li> <li> Invalid Stash API key: Setup wizard or settings page shows authentication error</li> <li> Network interruption during playback: Video pauses, shows buffering indicator, resumes when network recovers</li> </ul>"},{"location":"development/regression-testing/#112-invalid-data-handling","title":"11.2 Invalid Data Handling","text":"<p>Test Scenarios:</p> <ul> <li> Scene with missing file: Shows error message instead of playing, doesn't crash app</li> <li> Scene with invalid path mapping: Shows error message, allows user to update path mappings</li> <li> Corrupted video file: FFmpeg fails gracefully, shows error message</li> <li> Scene with no duration: Displays \"Unknown duration\" or defaults to 0, doesn't crash</li> <li> Scene with no title: Displays filename or \"Untitled\" instead of crashing</li> </ul>"},{"location":"development/regression-testing/#113-permission-errors","title":"11.3 Permission Errors","text":"<p>Test Scenarios:</p> <ul> <li> Non-admin tries to access admin features: Redirected or shown \"Access Denied\" message</li> <li> Expired JWT token: Redirected to login page with message \"Session expired\"</li> <li> Invalid JWT token: Redirected to login page, doesn't crash</li> </ul>"},{"location":"development/regression-testing/#114-database-errors","title":"11.4 Database Errors","text":"<p>Test Scenarios (requires simulating DB issues):</p> <ul> <li> Database locked: Shows error message, retries operation</li> <li> Database migration fails: Server logs error, shows setup wizard or maintenance page</li> <li> Database corruption: Server detects and shows recovery instructions</li> </ul>"},{"location":"development/regression-testing/#115-browser-compatibility","title":"11.5 Browser Compatibility","text":"<p>Test on Multiple Browsers:</p> <ul> <li> Chrome/Edge: All features work</li> <li> Firefox: All features work</li> <li> Safari: All features work (if targeting macOS/iOS)</li> <li> Mobile browsers: Responsive layout, touch controls work</li> </ul>"},{"location":"development/regression-testing/#performance-testing","title":"Performance Testing","text":""},{"location":"development/regression-testing/#121-load-times","title":"12.1 Load Times","text":"<ul> <li> Initial page load: &lt;3 seconds on broadband connection</li> <li> Scene grid load: &lt;2 seconds for first 40 scenes</li> <li> Video player load: &lt;3 seconds to first frame (direct playback)</li> <li> HLS stream start: &lt;5 seconds to first frame (transcoded playback)</li> <li> Search/filter response: &lt;500ms for typical library (&lt;10,000 scenes)</li> </ul>"},{"location":"development/regression-testing/#122-resource-usage","title":"12.2 Resource Usage","text":"<p>Precondition: Monitor browser DevTools Performance tab</p> <ul> <li> Memory usage: No memory leaks during 30-minute session</li> <li> CPU usage: &lt;20% CPU during idle browsing (not playing video)</li> <li> Network usage: Only necessary requests (no redundant API calls)</li> </ul>"},{"location":"development/regression-testing/#123-concurrent-sessions","title":"12.3 Concurrent Sessions","text":"<p>Test Scenarios:</p> <ul> <li> Multiple browser tabs: Can play different videos in 2+ tabs simultaneously</li> <li> Multiple users: 2+ users can log in and use app concurrently without interference</li> <li> Transcoding sessions: Multiple concurrent HLS streams don't exhaust server resources</li> </ul>"},{"location":"development/regression-testing/#mobile-and-responsive-testing","title":"Mobile and Responsive Testing","text":""},{"location":"development/regression-testing/#131-mobile-layout","title":"13.1 Mobile Layout","text":"<p>Precondition: Test on mobile device or browser DevTools mobile emulation</p> <ul> <li> Scenes grid adapts to narrow viewport (1-2 columns)</li> <li> Navigation menu becomes hamburger or bottom nav</li> <li> Scene cards remain readable and tappable (no tiny text/buttons)</li> <li> Video player controls are touch-friendly (large buttons)</li> <li> Search bar and filters accessible on mobile</li> <li> Settings page scrollable and functional</li> </ul>"},{"location":"development/regression-testing/#132-touch-controls","title":"13.2 Touch Controls","text":"<ul> <li> Tap scene card to play</li> <li> Swipe to scroll scene grid</li> <li> Pinch to zoom images (in galleries)</li> <li> Tap player controls to pause/play/seek</li> <li> Double-tap player to toggle fullscreen</li> <li> Swipe to navigate between scenes in playlist (if applicable)</li> </ul>"},{"location":"development/regression-testing/#post-release-monitoring","title":"Post-Release Monitoring","text":"<p>After deploying a new version to production:</p> <ol> <li>Check server logs: Look for errors or warnings in first 24 hours</li> <li>Monitor user reports: Track GitHub issues for bug reports</li> <li>Check update notifications: Verify users see update banner if applicable</li> <li>Database migrations: Confirm migrations ran successfully on user instances</li> <li>Performance: Monitor server resource usage (CPU, memory, disk) for anomalies</li> </ol>"},{"location":"development/regression-testing/#test-report-template","title":"Test Report Template","text":"<p>After completing regression testing, document results:</p> <pre><code>**Peek Stash Browser - Regression Test Report**\n\n**Version Tested**: 1.X.X\n**Test Date**: YYYY-MM-DD\n**Tester**: [Your Name]\n**Environment**:\n- Docker Version: X.X.X\n- Browser(s): Chrome X.X, Firefox X.X\n- Stash Version: X.X.X\n- Test Library Size: X scenes, Y performers, Z studios\n\n**Test Results Summary**:\n- Total Tests: X\n- Passed: X\n- Failed: X\n- Skipped: X (with reason)\n\n**Critical Issues Found**:\n1. [Issue description, steps to reproduce, severity]\n2. ...\n\n**High Priority Issues Found**:\n1. [Issue description, steps to reproduce, severity]\n2. ...\n\n**Medium/Low Priority Issues**:\n- [Brief list]\n\n**Recommendation**: \u2705 Ready for release / \u26a0\ufe0f Release with known issues / \u274c Do not release\n\n**Additional Notes**:\n[Any observations, performance notes, or suggestions]\n</code></pre>"},{"location":"development/regression-testing/#automation-recommendations","title":"Automation Recommendations","text":"<p>For future improvements, consider automating these tests:</p> <ul> <li>Unit tests: Core utility functions (path mapping, filter logic, etc.)</li> <li>Integration tests: API endpoints with mock data</li> <li>End-to-end tests: Playwright or Cypress for critical user flows (login, playback, search)</li> <li>Visual regression tests: Screenshot comparison for UI changes</li> <li>Performance tests: Lighthouse CI for page load metrics</li> </ul>"},{"location":"development/regression-testing/#updating-this-document","title":"Updating This Document","text":"<p>As new features are added, update this regression testing guide:</p> <ol> <li>Add new test sections for new features (e.g., \"14. Social Features\")</li> <li>Update existing tests if feature behavior changes</li> <li>Archive obsolete tests (mark as \"Deprecated\" if removed)</li> <li>Keep test steps concise and actionable</li> <li>Include preconditions and expected results for clarity</li> </ol> <p>Last Updated: 2025-01-21 (Version 1.6.0)</p>"},{"location":"getting-started/configuration/","title":"Configuration","text":"<p>Peek Stash Browser is configured through environment variables and the setup wizard. This page documents all available configuration options.</p>"},{"location":"getting-started/configuration/#required-environment-variables","title":"Required Environment Variables","text":"<p>These environment variables must be set for Peek to function:</p> Variable Description Example <code>STASH_URL</code> Your Stash GraphQL endpoint <code>http://192.168.1.100:9999/graphql</code> <code>STASH_API_KEY</code> API key from Stash settings <code>eyJhbGciOiJIUzI1NiIsInR5cCI6...</code> <code>JWT_SECRET</code> JWT signing key Generate with <code>openssl rand -base64 32</code>"},{"location":"getting-started/configuration/#getting-your-stash-api-key","title":"Getting Your Stash API Key","text":"<ol> <li>Open Stash web interface</li> <li>Navigate to Settings \u2192 Security</li> <li>In the API Key section, click Generate</li> <li>Copy the generated key</li> <li>Use this key as <code>STASH_API_KEY</code></li> </ol>"},{"location":"getting-started/configuration/#generating-jwt-secret","title":"Generating JWT Secret","text":"<p>Linux/macOS/unRAID: <pre><code>openssl rand -base64 32\n</code></pre></p> <p>Windows PowerShell: <pre><code>$rng = [System.Security.Cryptography.RandomNumberGenerator]::Create()\n$bytes = New-Object byte[] 32\n$rng.GetBytes($bytes)\n[Convert]::ToBase64String($bytes)\n</code></pre></p>"},{"location":"getting-started/configuration/#optional-environment-variables","title":"Optional Environment Variables","text":"<p>These settings have sensible defaults but can be customized:</p> Variable Description Default Notes <code>DATABASE_URL</code> SQLite database file <code>file:/app/data/peek-stash-browser.db</code> Path inside container <code>CONFIG_DIR</code> App data directory <code>/app/data</code> Database + HLS cache <code>TMP_DIR</code> Transcoding temp directory <code>/app/tmp</code> Needs fast I/O <code>NODE_ENV</code> Environment mode <code>production</code> <code>development</code> or <code>production</code>"},{"location":"getting-started/configuration/#path-mapping","title":"Path Mapping","text":"<p>Peek needs to access the same media files that Stash manages. There are two ways to configure path mappings:</p>"},{"location":"getting-started/configuration/#setup-wizard-recommended","title":"Setup Wizard (Recommended)","text":"<p>The 5-step setup wizard is the recommended way to configure path mappings for new installations:</p> <ol> <li>Auto-Discovery: Peek queries your Stash server via GraphQL to discover all library paths</li> <li>Path Mapping: You map each Stash library path to where Peek can access it in the container</li> <li>Database Storage: Mappings are stored in the database (no environment variables needed)</li> <li>Path Validation: Test each path to ensure Peek can access the files</li> <li>Multi-Library Support: Configure multiple library paths (videos, images, etc.)</li> </ol> <p>Access the wizard: - First-time installations show the wizard automatically at <code>http://your-server:6969</code> - Existing installations can manage mappings in Settings \u2192 Path Mappings</p>"},{"location":"getting-started/configuration/#upgrading-from-environment-variables","title":"Upgrading from Environment Variables","text":"<p>If you have an existing installation using <code>STASH_INTERNAL_PATH</code> and <code>STASH_MEDIA_PATH</code> environment variables:</p> <ol> <li>Access Peek in your browser</li> <li>Complete the setup wizard - it will guide you through path mapping</li> <li>Remove old environment variables from your container configuration:</li> <li><code>STASH_INTERNAL_PATH</code></li> <li><code>STASH_MEDIA_PATH</code></li> <li>Restart container</li> </ol> <p>The setup wizard replaces these environment variables with database-stored mappings that support multiple libraries.</p>"},{"location":"getting-started/configuration/#path-mapping-example","title":"Path Mapping Example","text":"<p>Setup: <pre><code># Stash Docker container\nvolumes:\n  - /mnt/user/videos:/data\n\n# Peek Docker container\nvolumes:\n  - /mnt/user/videos:/app/media:ro\n</code></pre></p> <p>In Setup Wizard: - Stash reports library path: <code>/data</code> - You configure Peek path: <code>/app/media</code> - Peek translates <code>/data/scenes/video.mp4</code> \u2192 <code>/app/media/scenes/video.mp4</code></p> <p>Multiple Libraries Example: <pre><code># Stash has two libraries: /data and /images\n# Peek Docker container\nvolumes:\n  - /mnt/user/stash/videos:/app/media:ro\n  - /mnt/user/stash/images:/app/images:ro\n</code></pre></p> <p>In Setup Wizard: - Library 1: <code>/data</code> \u2192 <code>/app/media</code> - Library 2: <code>/images</code> \u2192 <code>/app/images</code></p>"},{"location":"getting-started/configuration/#security-settings","title":"Security Settings","text":"Variable Description Default When to Use <code>SECURE_COOKIES</code> Enable secure cookie flag <code>false</code> Set to <code>true</code> when using HTTPS reverse proxy <p>Security Best Practices</p> <ul> <li>Set a strong <code>JWT_SECRET</code> during installation (required)</li> <li>Set <code>SECURE_COOKIES=true</code> when using HTTPS</li> <li>Don't expose Peek directly to the internet without a reverse proxy</li> <li>Admin credentials are created during setup wizard (no default passwords)</li> </ul>"},{"location":"getting-started/configuration/#example-configurations","title":"Example Configurations","text":""},{"location":"getting-started/configuration/#minimal-production-configuration","title":"Minimal Production Configuration","text":"<pre><code># Required\nSTASH_URL=http://192.168.1.100:9999/graphql\nSTASH_API_KEY=your_api_key_here\nJWT_SECRET=your_very_long_random_secret_key_here\n\n# Path mappings configured via setup wizard (stored in database)\n# All other settings use defaults\n</code></pre>"},{"location":"getting-started/configuration/#complete-production-configuration","title":"Complete Production Configuration","text":"<pre><code># Stash Integration (Required)\nSTASH_URL=http://192.168.1.100:9999/graphql\nSTASH_API_KEY=your_api_key_here\nJWT_SECRET=your_very_long_random_secret_key_here\n\n# Database (Optional - defaults shown)\nDATABASE_URL=file:/app/data/peek-stash-browser.db\nCONFIG_DIR=/app/data\n\n# Storage (Optional)\nTMP_DIR=/app/tmp\n\n# Security (Optional)\nSECURE_COOKIES=true\n\n# Environment (Optional)\nNODE_ENV=production\n\n# Path mappings configured via setup wizard (stored in database)\n</code></pre>"},{"location":"getting-started/configuration/#development-configuration","title":"Development Configuration","text":"<pre><code># Stash Integration\nSTASH_URL=http://localhost:9999/graphql\nSTASH_API_KEY=your_development_api_key\nJWT_SECRET=dev-secret-change-in-production\n\n# Database (local SQLite file)\nDATABASE_URL=file:./data/peek-db.db\n\n# Development\nNODE_ENV=development\n\n# Path mappings configured via setup wizard\n</code></pre>"},{"location":"getting-started/configuration/#docker-compose-example","title":"Docker Compose Example","text":"<pre><code>services:\n  peek:\n    image: carrotwaxr/peek-stash-browser:latest\n    container_name: peek-stash-browser\n    ports:\n      - \"6969:80\"\n    volumes:\n      - /mnt/user/videos:/app/media:ro\n      - peek-data:/app/data\n    environment:\n      # Required\n      - STASH_URL=http://stash:9999/graphql\n      - STASH_API_KEY=${STASH_API_KEY}\n      - JWT_SECRET=${JWT_SECRET}\n\n      # Optional\n      - NODE_ENV=production\n      - SECURE_COOKIES=false\n    restart: unless-stopped\n\nvolumes:\n  peek-data:\n</code></pre> <p>Path Mappings</p> <p>Path mappings are configured via the setup wizard and stored in the database (in the <code>peek-data</code> volume). No environment variables needed!</p>"},{"location":"getting-started/configuration/#troubleshooting-configuration-issues","title":"Troubleshooting Configuration Issues","text":""},{"location":"getting-started/configuration/#cannot-connect-to-stash","title":"Cannot Connect to Stash","text":"<p>Check:</p> <ul> <li><code>STASH_URL</code> is accessible from the Peek container</li> <li><code>STASH_API_KEY</code> is correct and not expired</li> <li>Stash GraphQL API is enabled</li> </ul> <p>Test connectivity:</p> <pre><code>docker exec peek-stash-browser curl http://your-stash-ip:9999/graphql\n</code></pre>"},{"location":"getting-started/configuration/#videos-wont-play","title":"Videos Won't Play","text":"<p>Check:</p> <ul> <li>Media volume is mounted correctly to container</li> <li>Path mappings are configured correctly in Settings \u2192 Path Mappings</li> <li>File permissions allow reading (use <code>:ro</code> for read-only mounts)</li> </ul> <p>Verify path mapping:</p> <pre><code># Check if media is accessible in container\ndocker exec peek-stash-browser ls -la /app/media\n\n# Check path mappings in database\ndocker exec peek-stash-browser cat /app/data/peek-stash-browser.db\n</code></pre> <p>Use the \"Test Path\" button in Settings \u2192 Path Mappings to verify each path.</p>"},{"location":"getting-started/configuration/#authentication-issues","title":"Authentication Issues","text":"<p>Check:</p> <ul> <li><code>JWT_SECRET</code> is set</li> <li><code>SECURE_COOKIES</code> matches your HTTP/HTTPS setup</li> <li>Database is writable</li> </ul>"},{"location":"getting-started/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide</li> <li>Troubleshooting</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>Peek Stash Browser can be deployed in several ways depending on your needs and environment.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<p>Before installing Peek, ensure you have:</p> <ul> <li>Stash Server running with GraphQL API enabled</li> <li>Docker installed (Docker Compose only needed for development)</li> <li>Network access from container to Stash server</li> <li>Storage space for SQLite database and transcoding temp files</li> </ul>"},{"location":"getting-started/installation/#stash-configuration","title":"Stash Configuration","text":"<ol> <li>Enable API in Stash settings</li> <li>Generate API key in Settings \u2192 Security</li> <li>Note GraphQL endpoint (usually <code>http://stash-ip:9999/graphql</code>)</li> <li>Ensure network access from your Docker host to Stash</li> </ol>"},{"location":"getting-started/installation/#understanding-path-mapping","title":"Understanding Path Mapping","text":"<p>Peek needs to access the same media files that Stash manages. How you configure this depends on your setup:</p>"},{"location":"getting-started/installation/#scenario-1-peek-and-stash-on-same-machine","title":"Scenario 1: Peek and Stash on Same Machine","text":"<p>Example: Both running in Docker on the same host</p> <pre><code># Simple - just mount the same directory both containers use (read-only recommended)\n-v /mnt/media:/app/media:ro\n</code></pre>"},{"location":"getting-started/installation/#scenario-2-peek-on-windows-stash-on-network-server","title":"Scenario 2: Peek on Windows, Stash on Network Server","text":"<p>Example: Stash on unRAID/NAS, Peek on Windows desktop</p> <p>If your network shares are password-protected, use Docker volumes:</p> <pre><code># One-time: Create Docker volume for password-protected SMB share\ndocker volume create peek-media `\n  --driver local `\n  --opt type=cifs `\n  --opt device=//192.168.1.100/media `\n  --opt o=username=youruser,password=yourpass\n\n# Then use the volume in docker run (read-only recommended)\n-v peek-media:/app/media:ro\n</code></pre> <p>See Windows Installation Examples below for complete examples.</p>"},{"location":"getting-started/installation/#scenario-3-multiple-stash-libraries","title":"Scenario 3: Multiple Stash Libraries","text":"<p>Example: Stash has separate folders for videos and images</p> <p>The setup wizard will auto-discover all your Stash libraries and help you map each one:</p> <ul> <li><code>/data</code> (videos) \u2192 <code>/app/media</code></li> <li><code>/images</code> (images) \u2192 <code>/app/images</code></li> </ul>"},{"location":"getting-started/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"getting-started/installation/#option-1-unraid","title":"Option 1: unRAID","text":""},{"location":"getting-started/installation/#community-applications-recommended","title":"Community Applications (Recommended)","text":"<p>Easiest Installation Method</p> <p>This is the recommended method for unRAID users - everything is pre-configured!</p> <ol> <li>Install from Community Applications:</li> <li>Search for \"Peek Stash Browser\" in unRAID's Community Applications</li> <li>Click install and configure your settings</li> <li>Access at <code>http://your-unraid-ip:6969</code></li> </ol>"},{"location":"getting-started/installation/#manual-template-installation","title":"Manual Template Installation","text":"<p>If Peek isn't available in Community Applications yet, or if you want to install the latest template manually:</p> <p>Step 1: Download the template file</p> <p>Get the template from GitHub:</p> <pre><code>https://raw.githubusercontent.com/carrotwaxr/peek-stash-browser/master/unraid-template.xml\n</code></pre> <p>Step 2: Install the template</p> <p>=== \"USB/Boot Share Exported (Easier)\" 1. Copy <code>unraid-template.xml</code> to your network share at: <code>\\\\your.server.ip.address\\flash\\config\\plugins\\dockerMan\\templates-user</code> 2. The template will be available immediately in Docker tab \u2192 Add Container \u2192 User Templates</p> <p>=== \"USB/Boot Share NOT Exported\" 1. Copy <code>unraid-template.xml</code> to any accessible share (e.g., <code>\\\\your.server.ip.address\\downloads</code>) 2. SSH into your unRAID server 3. Move the template file: <code>bash        cp /mnt/user/downloads/unraid-template.xml /boot/config/plugins/dockerMan/templates-user/</code> 4. The template will be available immediately in Docker tab \u2192 Add Container \u2192 User Templates</p> <p>No Restart Required</p> <p>You do NOT need to restart Docker or unRAID - the template is picked up automatically.</p> <p>Step 3: Configure the container</p> <ol> <li>Go to Docker tab \u2192 Add Container</li> <li>Select \"peek-stash-browser\" from User Templates dropdown</li> <li>Configure required settings:</li> <li>Stash GraphQL URL: <code>http://your-unraid-ip:9999/graphql</code></li> <li>Stash API Key: Get from Stash Settings \u2192 Security</li> <li>JWT Secret: Generate with <code>openssl rand -hex 32</code> in unRAID terminal</li> <li>Media Directory: Path to your Stash media (e.g., <code>/mnt/user/videos</code>)</li> <li>App Data Directory: Path for Peek data (e.g., <code>/mnt/user/appdata/peek-stash-browser</code>)</li> <li>Click Apply</li> <li>Access at <code>http://your-unraid-ip:6969</code></li> </ol>"},{"location":"getting-started/installation/#option-2-docker-single-container","title":"Option 2: Docker (Single Container)","text":"<p>Recommended for Production</p> <p>Single container includes everything - frontend, backend, and database</p> <pre><code># Pull the latest image\ndocker pull carrotwaxr/peek-stash-browser:latest\n\n# Generate JWT secret\nexport JWT_SECRET=$(openssl rand -base64 32)\n\n# Run with single library\ndocker run -d \\\n  --name peek-stash-browser \\\n  -p 6969:80 \\\n  -v /path/to/your/media:/app/media:ro \\\n  -v peek-data:/app/data \\\n  -e STASH_URL=\"http://your-stash-server:9999/graphql\" \\\n  -e STASH_API_KEY=\"your_stash_api_key\" \\\n  -e JWT_SECRET=\"${JWT_SECRET}\" \\\n  carrotwaxr/peek-stash-browser:latest\n\n# Run with multiple libraries (if Stash has separate video/image libraries)\ndocker run -d \\\n  --name peek-stash-browser \\\n  -p 6969:80 \\\n  -v /path/to/stash/videos:/app/media:ro \\\n  -v /path/to/stash/images:/app/images:ro \\\n  -v /path/to/stash/other:/app/other:ro \\\n  -v peek-data:/app/data \\\n  -e STASH_URL=\"http://your-stash-server:9999/graphql\" \\\n  -e STASH_API_KEY=\"your_stash_api_key\" \\\n  -e JWT_SECRET=\"${JWT_SECRET}\" \\\n  carrotwaxr/peek-stash-browser:latest\n</code></pre> <p>Volume Mounts:</p> <ul> <li><code>/path/to/your/media</code> - Your media files (read-only recommended with <code>:ro</code>)</li> <li><code>peek-data</code> - Database and app data (Docker named volume)</li> </ul> <p>Multiple Libraries</p> <p>If Stash has multiple library paths, mount each one separately. The setup wizard will auto-discover them and help you configure the mappings.</p> <p>Required Environment Variables:</p> <ul> <li><code>STASH_URL</code> - Your Stash GraphQL endpoint</li> <li><code>STASH_API_KEY</code> - API key from Stash settings</li> <li><code>JWT_SECRET</code> - Secret for JWT authentication (recommended to set manually)</li> </ul> <p>See Configuration Guide for all environment variables.</p>"},{"location":"getting-started/installation/#windows-examples","title":"Windows Examples","text":"<p>Windows users with network shares (SMB/CIFS) need special configuration for password-protected shares.</p> <p>Windows Network Shares</p> <p>Docker Desktop on Windows cannot directly mount password-protected network shares using drive letters (Z:, X:, etc.). Use Docker volumes with CIFS credentials instead.</p> <p>Step 1: Find your UNC path</p> <p>If you have a mapped drive, find its UNC path:</p> <pre><code># In PowerShell\nnet use Z:\n# Look for \"Remote name\" in the output (e.g., \\\\192.168.1.100\\media)\n</code></pre> <p>Step 2: Create Docker volumes (one-time setup)</p> <pre><code># Pull the latest image from Docker Hub\ndocker pull carrotwaxr/peek-stash-browser:latest\n\n# Generate JWT secret (one-time)\n$rng = [System.Security.Cryptography.RandomNumberGenerator]::Create()\n$bytes = New-Object byte[] 32\n$rng.GetBytes($bytes)\n$jwt = [Convert]::ToBase64String($bytes)\n\n# For single library:\ndocker volume create peek-media `\n  --driver local `\n  --opt type=cifs `\n  --opt device=//192.168.1.100/stash `\n  --opt o=username=youruser,password=yourpass\n\n# For multiple libraries (create one volume per library):\ndocker volume create peek-videos `\n  --driver local `\n  --opt type=cifs `\n  --opt device=//192.168.1.100/stash/videos `\n  --opt o=username=youruser,password=yourpass\n\ndocker volume create peek-images `\n  --driver local `\n  --opt type=cifs `\n  --opt device=//192.168.1.100/stash/images `\n  --opt o=username=youruser,password=yourpass\n\n# Create volume for Peek data (persists database)\ndocker volume create peek-data\n</code></pre> <p>Volumes persist across reboots!</p> <p>These volumes are created once and survive container restarts, system reboots, and Docker Desktop restarts.</p> <p>Step 3: Run Peek container</p> <pre><code># Single library\ndocker run -d `\n    --name peek-stash-browser `\n    -p 6969:80 `\n    -v peek-media:/app/media:ro `\n    -v peek-data:/app/data `\n    -e STASH_URL=http://192.168.1.100:9999/graphql `\n    -e STASH_API_KEY=your_api_key_here `\n    -e JWT_SECRET=$jwt `\n    carrotwaxr/peek-stash-browser:latest\n\n# Multiple libraries\ndocker run -d `\n    --name peek-stash-browser `\n    -p 6969:80 `\n    -v peek-videos:/app/media:ro `\n    -v peek-images:/app/images:ro `\n    -v peek-data:/app/data `\n    -e STASH_URL=http://192.168.1.100:9999/graphql `\n    -e STASH_API_KEY=your_api_key_here `\n    -e JWT_SECRET=$jwt `\n    carrotwaxr/peek-stash-browser:latest\n</code></pre> <p>Multiple Libraries</p> <p>Create one Docker volume for each Stash library path. Media volumes are mounted read-only (<code>:ro</code>) to prevent accidental modifications. The setup wizard will auto-discover all libraries and help you map them.</p> <p>Managing the container:</p> <pre><code># View logs\ndocker logs peek-stash-browser\n\n# Stop container\ndocker stop peek-stash-browser\n\n# Start container\ndocker start peek-stash-browser\n\n# Restart container\ndocker restart peek-stash-browser\n\n# Update to new version\ndocker stop peek-stash-browser\ndocker rm peek-stash-browser\ndocker pull carrotwaxr/peek-stash-browser:latest\n# Then re-run the docker run command above\n</code></pre> <p>Volumes are preserved!</p> <p>Your database and configuration are saved in the <code>peek-data</code> volume and won't be lost when updating.</p>"},{"location":"getting-started/installation/#linuxmacos-examples","title":"Linux/macOS Examples","text":"<p>Linux and macOS users can mount directories directly without the complexity of network share authentication.</p> <p>Step 1: Pull image and generate JWT secret</p> <pre><code># Pull the latest image from Docker Hub\ndocker pull carrotwaxr/peek-stash-browser:latest\n\n# Generate a secure random JWT secret\nexport JWT_SECRET=$(openssl rand -base64 32)\n</code></pre> <p>Step 2: Run Peek container</p> <pre><code># Single Stash library\ndocker run -d \\\n    --name peek-stash-browser \\\n    -p 6969:80 \\\n    -v /path/to/stash/media:/app/media:ro \\\n    -v peek-data:/app/data \\\n    -e STASH_URL=http://192.168.1.100:9999/graphql \\\n    -e STASH_API_KEY=your_api_key_here \\\n    -e JWT_SECRET=\"${JWT_SECRET}\" \\\n    carrotwaxr/peek-stash-browser:latest\n\n# Multiple Stash libraries (videos + images + other)\ndocker run -d \\\n    --name peek-stash-browser \\\n    -p 6969:80 \\\n    -v /path/to/stash/videos:/app/media:ro \\\n    -v /path/to/stash/images:/app/images:ro \\\n    -v /path/to/stash/other:/app/other:ro \\\n    -v peek-data:/app/data \\\n    -e STASH_URL=http://192.168.1.100:9999/graphql \\\n    -e STASH_API_KEY=your_api_key_here \\\n    -e JWT_SECRET=\"${JWT_SECRET}\" \\\n    carrotwaxr/peek-stash-browser:latest\n</code></pre> <p>Read-only mounts recommended</p> <p>Use <code>:ro</code> flag on media mounts to prevent accidental modifications to your Stash library</p> <p>Multiple Libraries</p> <p>Mount each Stash library path separately. The setup wizard will auto-discover all libraries and help you map them.</p> <p>Managing the container:</p> <pre><code># View logs\ndocker logs peek-stash-browser\n\n# Follow logs in real-time\ndocker logs -f peek-stash-browser\n\n# Stop container\ndocker stop peek-stash-browser\n\n# Start container\ndocker start peek-stash-browser\n\n# Restart container\ndocker restart peek-stash-browser\n\n# Update to new version\ndocker stop peek-stash-browser\ndocker rm peek-stash-browser\ndocker pull carrotwaxr/peek-stash-browser:latest\n# Then re-run the docker run command above\n</code></pre> <p>Data persists across updates!</p> <p>Your database and configuration are saved in the <code>peek-data</code> volume and won't be lost when updating.</p>"},{"location":"getting-started/installation/#option-3-docker-compose-development","title":"Option 3: Docker Compose (Development)","text":"<p>For Development Only</p> <p>This method is for development with hot reloading enabled</p> <ol> <li>Clone and setup:</li> </ol> <pre><code>git clone https://github.com/carrotwaxr/peek-stash-browser.git\ncd peek-stash-browser\ncp .env.example .env\n</code></pre> <ol> <li>Configure environment (edit <code>.env</code>):</li> </ol> <pre><code>STASH_URL=http://your-stash-server:9999/graphql\nSTASH_API_KEY=your_stash_api_key\nDATABASE_URL=file:./data/peek-stash-browser.db\nTMP_DIR=/path/to/temp/directory\n</code></pre> <ol> <li>Start services:</li> </ol> <pre><code>docker-compose up -d\n</code></pre> <ol> <li>Access the app: Open <code>http://localhost:6969</code></li> </ol>"},{"location":"getting-started/installation/#first-access-setup-wizard","title":"First Access &amp; Setup Wizard","text":"<p>After installation, access Peek in your browser for the first-time setup:</p> <ol> <li>Navigate to <code>http://localhost:6969</code> (or your server IP)</li> <li>Complete the 5-step setup wizard:</li> <li>Welcome: Introduction to Peek</li> <li>Discover Libraries: Auto-discover Stash library paths</li> <li>Configure Paths: Map Stash paths to Peek container paths</li> <li>Create Admin: Set your admin password</li> <li>Complete: Setup finished!</li> <li>Login with your newly created admin credentials</li> </ol> <p>Path Mapping Made Easy</p> <p>The wizard auto-discovers your Stash library paths and helps you map them correctly!</p>"},{"location":"getting-started/installation/#updating-peek","title":"Updating Peek","text":""},{"location":"getting-started/installation/#check-for-updates","title":"Check for Updates","text":"<p>Peek includes a built-in update checker:</p> <ol> <li>Navigate to Settings \u2192 Server Settings</li> <li>Scroll to the Version Information section</li> <li>Click Check for Updates</li> </ol> <p>The system will query GitHub for new releases and notify you if an update is available.</p>"},{"location":"getting-started/installation/#update-procedure","title":"Update Procedure","text":"<p>To update your Docker container to the latest version:</p> unRAIDLinux/macOSWindows <p>Easiest method: Click Force Update in the Docker tab to pull the latest image and restart.</p> <pre><code># Stop and remove current container\ndocker stop peek-stash-browser\ndocker rm peek-stash-browser\n\n# Pull latest image\ndocker pull carrotwaxr/peek-stash-browser:latest\n\n# Restart with same docker run command you used for installation\ndocker run -d \\\n  --name peek-stash-browser \\\n  -p 6969:80 \\\n  -v /path/to/stash/media:/app/media:ro \\\n  -v peek-data:/app/data \\\n  -e STASH_URL=http://192.168.1.100:9999/graphql \\\n  -e STASH_API_KEY=your_api_key_here \\\n  -e JWT_SECRET=\"${JWT_SECRET}\" \\\n  carrotwaxr/peek-stash-browser:latest\n</code></pre> <pre><code># Stop and remove current container\ndocker stop peek-stash-browser\ndocker rm peek-stash-browser\n\n# Pull latest image\ndocker pull carrotwaxr/peek-stash-browser:latest\n\n# Restart with same docker run command you used for installation\ndocker run -d `\n  --name peek-stash-browser `\n  -p 6969:80 `\n  -v peek-media:/app/media:ro `\n  -v peek-data:/app/data `\n  -e STASH_URL=http://192.168.1.100:9999/graphql `\n  -e STASH_API_KEY=your_api_key_here `\n  -e JWT_SECRET=$jwt `\n  carrotwaxr/peek-stash-browser:latest\n</code></pre> <p>Your data persists across updates</p> <p>Database, user settings, path mappings, and playlists are stored in the <code>peek-data</code> volume and will not be lost.</p>"},{"location":"getting-started/installation/#version-pinning","title":"Version Pinning","text":"<p>To use a specific version instead of <code>:latest</code>:</p> <pre><code># Pull and use specific version\ndocker pull carrotwaxr/peek-stash-browser:1.0.0\ndocker run ... carrotwaxr/peek-stash-browser:1.0.0\n</code></pre> <p>Available versions: GitHub Releases</p>"},{"location":"getting-started/installation/#port-configuration","title":"Port Configuration","text":"Environment Port Service Description Production <code>6969</code> Complete App nginx serves frontend + proxies API Development <code>6969</code> Frontend UI Vite dev server with hot reloading Development <code>8000</code> Backend API Express server (internal Docker network) <p>Production uses only one port!</p> <p>Production deployment exposes only port <code>6969</code> - nginx handles everything internally</p>"},{"location":"getting-started/installation/#hardware-recommendations","title":"Hardware Recommendations","text":"Component Minimum Recommended CPU 2 cores 4+ cores (for multiple transcoding streams) RAM 2GB 4GB+ Storage SSD for database SSD for database, network storage for media Network 100 Mbps Gigabit (for 4K content)"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Configure environment variables</li> <li>Quick Start Guide</li> <li>Troubleshooting</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Get Peek up and running in 5 minutes!</p>"},{"location":"getting-started/quick-start/#step-1-install-peek","title":"Step 1: Install Peek","text":"Docker (Fastest)unRAIDDocker Compose <pre><code># Pull the latest image\ndocker pull carrotwaxr/peek-stash-browser:latest\n\n# Generate JWT secret\nexport JWT_SECRET=$(openssl rand -base64 32)\n\n# Run Peek\ndocker run -d \\\n  --name peek-stash-browser \\\n  -p 6969:80 \\\n  -v /path/to/media:/app/media:ro \\\n  -v peek-data:/app/data \\\n  -e STASH_URL=\"http://your-stash:9999/graphql\" \\\n  -e STASH_API_KEY=\"your_api_key\" \\\n  -e JWT_SECRET=\"${JWT_SECRET}\" \\\n  carrotwaxr/peek-stash-browser:latest\n</code></pre> <ol> <li>Search \"Peek Stash Browser\" in Community Applications</li> <li>Click Install</li> <li>Configure Stash URL and API key</li> <li>Generate JWT secret: <code>openssl rand -hex 32</code></li> <li>Click Apply</li> </ol> <pre><code>git clone https://github.com/carrotwaxr/peek-stash-browser.git\ncd peek-stash-browser\ncp .env.example .env\n# Edit .env with your settings\ndocker-compose up -d\n</code></pre>"},{"location":"getting-started/quick-start/#step-2-setup-wizard","title":"Step 2: Setup Wizard","text":"<ol> <li>Open browser: <code>http://localhost:6969</code> (or your server IP)</li> <li>Complete the 5-step setup wizard:</li> <li>Welcome - Introduction to Peek</li> <li>Discover Libraries - Auto-discover your Stash library paths</li> <li>Configure Paths - Map Stash paths to Peek container paths</li> <li>Create Admin - Set your admin username and password</li> <li>Complete - Setup finished!</li> </ol> <p>Path Mapping Made Easy</p> <p>The wizard automatically discovers your Stash libraries and helps you configure path mappings correctly!</p>"},{"location":"getting-started/quick-start/#step-3-browse-your-library","title":"Step 3: Browse Your Library","text":"<ul> <li>Scenes: Browse all your video content</li> <li>Performers: View performers and their scenes</li> <li>Studios: Explore by production company</li> <li>Tags: Find content by tags</li> </ul>"},{"location":"getting-started/quick-start/#step-4-watch-videos","title":"Step 4: Watch Videos","text":"<ol> <li>Click any scene to view details</li> <li>Click Play to start video</li> <li>Quality automatically adjusts based on network</li> <li>Use timeline to seek through video</li> </ol>"},{"location":"getting-started/quick-start/#step-5-create-playlists","title":"Step 5: Create Playlists","text":"<p>Organize your favorite scenes into custom playlists:</p> <ol> <li>Click Playlists in the navigation menu</li> <li>Click Create Playlist</li> <li>Enter a name and optional description</li> <li>Click Create</li> </ol> <p>Adding Scenes: - Click the + icon on any scene card - Select your playlist from the menu - Scene is added instantly!</p> <p>Playing Playlists: - Click a playlist to view its scenes - Click Play to start playback - Use Shuffle to randomize order - Use Repeat to loop your playlist</p> <p>Learn More</p> <p>See the Complete Playlists Guide for reordering scenes, editing playlists, and more!</p>"},{"location":"getting-started/quick-start/#common-tasks","title":"Common Tasks","text":""},{"location":"getting-started/quick-start/#update-admin-password","title":"Update Admin Password","text":"<ol> <li>Click user icon (top right)</li> <li>Select Settings</li> <li>Enter new password</li> <li>Click Save</li> </ol>"},{"location":"getting-started/quick-start/#create-additional-users","title":"Create Additional Users","text":"<ol> <li>Go to Users (admin only)</li> <li>Click Create User</li> <li>Enter username, email, password</li> <li>Select role (Admin or User)</li> <li>Click Create</li> </ol>"},{"location":"getting-started/quick-start/#configure-theme","title":"Configure Theme","text":"<ol> <li>Click theme toggle icon (moon/sun)</li> <li>Choose Dark or Light mode</li> <li>Theme preference is saved automatically</li> </ol>"},{"location":"getting-started/quick-start/#video-playback-tips","title":"Video Playback Tips","text":"<ul> <li>Direct Play: If browser supports the format, plays directly (no transcoding)</li> <li>Transcoded: HLS streaming with adaptive quality when needed</li> <li>Seeking: Full timeline scrubbing works in both modes</li> <li>Quality: Click quality button to manually select resolution</li> </ul>"},{"location":"getting-started/quick-start/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"Key Action <code>Space</code> Play/Pause <code>\u2190</code> Seek backward 10s <code>\u2192</code> Seek forward 10s <code>\u2191</code> Volume up <code>\u2193</code> Volume down <code>F</code> Toggle fullscreen <code>M</code> Mute/unmute <p>Full Keyboard Navigation</p> <p>Peek supports complete keyboard navigation including TV mode! See the Keyboard Navigation Guide for all shortcuts.</p>"},{"location":"getting-started/quick-start/#troubleshooting-first-time-issues","title":"Troubleshooting First-Time Issues","text":""},{"location":"getting-started/quick-start/#cant-login","title":"Can't Login","text":"<ul> <li>Check container logs: <code>docker logs peek-stash-browser</code></li> <li>Verify database was created in <code>/app/data</code></li> <li>Ensure <code>JWT_SECRET</code> is set (or auto-generated)</li> </ul>"},{"location":"getting-started/quick-start/#no-scenes-showing","title":"No Scenes Showing","text":"<ul> <li>Check <code>STASH_URL</code> is correct</li> <li>Verify <code>STASH_API_KEY</code> is valid</li> <li>Test Stash connectivity from container:   <pre><code>docker exec peek-stash-browser curl http://your-stash:9999/graphql\n</code></pre></li> </ul>"},{"location":"getting-started/quick-start/#videos-wont-play","title":"Videos Won't Play","text":"<ul> <li>Verify media path is mounted correctly:   <pre><code>docker exec peek-stash-browser ls /app/media\n</code></pre></li> <li>Check path mapping configuration</li> <li>Ensure FFmpeg is installed (included in official image)</li> </ul>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>Full Configuration Guide</li> <li>Complete Troubleshooting</li> </ul>"},{"location":"getting-started/quick-start/#need-help","title":"Need Help?","text":"<ul> <li>Troubleshooting Guide</li> <li>GitHub Issues</li> <li>Stash Discord - #third-party-integrations channel</li> </ul>"},{"location":"reference/faq/","title":"Frequently Asked Questions","text":"<p>Common questions about Peek Stash Browser.</p>"},{"location":"reference/faq/#general","title":"General","text":""},{"location":"reference/faq/#what-is-peek","title":"What is Peek?","text":"<p>Peek is a modern web application for browsing and streaming Stash media content with real-time HLS transcoding. It provides a fast, responsive interface with adaptive quality streaming.</p>"},{"location":"reference/faq/#how-is-peek-different-from-stash","title":"How is Peek different from Stash?","text":"<p>Peek is a browser/player focused on video playback, while Stash is a comprehensive media organizer. Peek:</p> <ul> <li>Focuses on smooth video playback with adaptive streaming</li> <li>Provides a simplified, browsing-focused interface</li> <li>Uses real-time transcoding for universal compatibility</li> <li>Complements Stash rather than replacing it</li> </ul>"},{"location":"reference/faq/#does-peek-modify-my-stash-library","title":"Does Peek modify my Stash library?","text":"<p>No. Peek is read-only. It connects to Stash's GraphQL API to read data but never modifies your library, files, or metadata.</p>"},{"location":"reference/faq/#installation","title":"Installation","text":""},{"location":"reference/faq/#what-platforms-are-supported","title":"What platforms are supported?","text":"<ul> <li>unRAID: Community Applications or manual Docker install</li> <li>Docker: Any platform supporting Docker</li> <li>Development: Node.js 18+ on Windows/Mac/Linux</li> </ul>"},{"location":"reference/faq/#do-i-need-a-separate-database-server","title":"Do I need a separate database server?","text":"<p>No. Peek uses embedded SQLite. No PostgreSQL, MySQL, or other database server needed.</p>"},{"location":"reference/faq/#can-i-run-peek-and-stash-on-the-same-server","title":"Can I run Peek and Stash on the same server?","text":"<p>Yes. They run as separate containers and don't conflict.</p>"},{"location":"reference/faq/#video-playback","title":"Video Playback","text":""},{"location":"reference/faq/#why-does-transcoding-take-so-long","title":"Why does transcoding take so long?","text":"<p>Transcoding is CPU-intensive. Performance depends on:</p> <ul> <li>Server CPU power</li> <li>Storage I/O speed (SSD vs HDD vs network)</li> <li>Original video codec and resolution</li> <li>Target quality selected</li> </ul> <p>For best performance, use local SSD storage and allocate 2-4 CPU cores.</p>"},{"location":"reference/faq/#can-i-play-videos-directly-without-transcoding","title":"Can I play videos directly without transcoding?","text":"<p>Yes! Direct play is available when your browser supports the video codec. Use the quality selector and choose Direct to play the original file without transcoding.</p> <p>When to use Direct: - Fastest playback (no transcoding delay) - Highest quality (original file) - Browser supports the video format</p> <p>When to use transcoding: - Browser doesn't support the format - Want adaptive quality (switch between 720p/480p/360p) - Slower network connections</p>"},{"location":"reference/faq/#can-i-download-the-original-video-file","title":"Can I download the original video file?","text":"<p>Not yet. Video downloads are planned for a future release. Currently, you can only stream videos through Peek's player.</p>"},{"location":"reference/faq/#configuration","title":"Configuration","text":""},{"location":"reference/faq/#where-are-my-settings-stored","title":"Where are my settings stored?","text":"<ul> <li>User preferences: SQLite database in <code>/app/data/peek-db.db</code></li> <li>Server config: Environment variables</li> <li>Temp files: <code>/app/data/hls-cache/</code> (auto-cleaned)</li> </ul>"},{"location":"reference/faq/#how-do-i-backup-my-data","title":"How do I backup my data?","text":"<pre><code># Backup SQLite database\ndocker exec peek-stash-browser sqlite3 /app/data/peek-db.db \".backup /app/data/backup.db\"\n\n# Copy backup out of container\ndocker cp peek-stash-browser:/app/data/backup.db ./peek-backup.db\n</code></pre>"},{"location":"reference/faq/#can-i-customize-the-theme","title":"Can I customize the theme?","text":"<p>Yes! Peek includes several built-in themes and a custom theme editor.</p> <p>Built-in Themes: - Light Mode - Dark Mode (default) - Deep Purple - The Hub</p> <p>Custom Theme Editor: 1. Go to Settings \u2192 My Settings 2. Scroll to Custom Themes section 3. Create your own theme by choosing colors 4. Customize fonts, backgrounds, text colors, and more 5. Save and apply your custom theme</p> <p>Toggle between themes using the theme icon in the navigation bar.</p>"},{"location":"reference/faq/#performance","title":"Performance","text":""},{"location":"reference/faq/#how-many-concurrent-streams-can-peek-handle","title":"How many concurrent streams can Peek handle?","text":"<p>Depends on server CPU:</p> <ul> <li>2 CPU cores: 1-2 streams at 720p</li> <li>4 CPU cores: 3-4 streams at 720p</li> <li>6+ CPU cores: 5+ streams at 720p</li> </ul> <p>Lower qualities (480p, 360p) require less CPU and support more concurrent streams.</p>"},{"location":"reference/faq/#why-is-my-media-loading-slowly","title":"Why is my media loading slowly?","text":"<p>Check storage speed:</p> <pre><code>docker exec peek-stash-browser dd if=/app/media/test.mp4 of=/dev/null bs=1M count=100\n</code></pre> <p>If &lt; 50 MB/s, media is likely on: - Network share (SMB/NFS) - Move to local storage - Slow HDD - Upgrade to SSD - USB drive - Use internal storage</p>"},{"location":"reference/faq/#how-much-disk-space-does-peek-need","title":"How much disk space does Peek need?","text":"<ul> <li>App data: ~100 MB (database, config)</li> <li>Temp files: ~50-100 MB per quality per minute of video</li> <li>Recommendation: 5-10 GB for temp storage on busy servers</li> </ul> <p>Temp files are automatically cleaned up after 30 minutes.</p>"},{"location":"reference/faq/#troubleshooting","title":"Troubleshooting","text":""},{"location":"reference/faq/#videos-wont-play","title":"Videos won't play","text":"<ol> <li>Check FFmpeg is installed: <code>docker exec peek-stash-browser ffmpeg -version</code></li> <li>Verify path mapping is correct</li> <li>Check file permissions on media</li> <li>Review backend logs for errors</li> </ol> <p>See: Troubleshooting Guide</p>"},{"location":"reference/faq/#cant-connect-to-stash","title":"Can't connect to Stash","text":"<ol> <li>Verify <code>STASH_URL</code> is correct and accessible from container</li> <li>Check Stash API key is valid</li> <li>Test connectivity: <code>docker exec peek-stash-browser curl http://stash:9999/graphql</code></li> </ol>"},{"location":"reference/faq/#login-doesnt-work","title":"Login doesn't work","text":"<ul> <li>Check cookies are enabled</li> <li>Verify <code>JWT_SECRET</code> is set</li> <li>Try incognito mode</li> <li>Clear browser cache</li> </ul>"},{"location":"reference/faq/#features","title":"Features","text":""},{"location":"reference/faq/#how-do-playlists-work","title":"How do playlists work?","text":"<p>Playlists are fully available! Create custom playlists of your favorite scenes.</p> <p>Creating a Playlist: 1. Click Playlists in the navigation 2. Click Create Playlist 3. Enter a name and description 4. Click Create</p> <p>Adding Scenes: - Click the + icon on any scene card - Select the playlist to add it to - Or go to a scene's detail page and click Add to Playlist</p> <p>Playing Playlists: - Click a playlist to view its scenes - Click Play to start from the beginning - Use Shuffle to randomize playback order - Use Repeat (all or one) for continuous playback - Reorder scenes by dragging them in edit mode</p> <p>Learn More</p> <p>See the Complete Playlists Guide for detailed instructions on managing and playing playlists.</p>"},{"location":"reference/faq/#does-peek-track-watch-history","title":"Does Peek track watch history?","text":"<p>Yes! Peek automatically tracks your viewing progress and lets you resume playback from where you left off.</p> <p>Features: - Automatic progress tracking during playback - Resume from any device (synced to your user account) - \"Continue Watching\" section on home page - Progress bars on scene cards - Clear history for individual scenes or all at once</p> <p>Learn More</p> <p>See the Watch History Guide for complete details on managing your watch history.</p>"},{"location":"reference/faq/#can-i-use-keyboard-navigation","title":"Can I use keyboard navigation?","text":"<p>Yes! Peek supports complete keyboard navigation, perfect for TV remotes or wireless keyboards.</p> <p>Key features: - Arrow keys navigate scene grids and lists - Enter to select/play - Video player keyboard shortcuts (Space, arrows, F for fullscreen) - Playlist controls (N for next, P for previous) - TV Mode optimized for couch browsing</p> <p>Learn More</p> <p>See the Keyboard Navigation Guide for all keyboard shortcuts and TV mode setup.</p>"},{"location":"reference/faq/#can-i-use-peek-on-mobile","title":"Can I use Peek on mobile?","text":"<p>Yes. The web interface is responsive and works on mobile browsers. A dedicated mobile app is not currently planned.</p>"},{"location":"reference/faq/#does-peek-support-hardware-transcoding","title":"Does Peek support hardware transcoding?","text":"<p>Not yet. Hardware-accelerated transcoding (GPU) is planned for a future release to improve performance and reduce CPU usage.</p>"},{"location":"reference/faq/#can-i-use-peek-without-stash","title":"Can I use Peek without Stash?","text":"<p>No. Peek requires a Stash server for media library management and metadata. Peek is designed as a companion to Stash, not a replacement.</p>"},{"location":"reference/faq/#security","title":"Security","text":""},{"location":"reference/faq/#is-peek-secure","title":"Is Peek secure?","text":"<p>Peek includes: - JWT authentication - Bcrypt password hashing - Read-only media access - Session management</p> <p>Important: Change the default admin password immediately!</p>"},{"location":"reference/faq/#should-i-expose-peek-to-the-internet","title":"Should I expose Peek to the internet?","text":"<p>No. Peek is designed for local network use. For remote access: - Use VPN - Use reverse proxy with authentication layer - Don't expose directly to internet</p>"},{"location":"reference/faq/#support","title":"Support","text":""},{"location":"reference/faq/#where-can-i-get-help","title":"Where can I get help?","text":"<ul> <li>Documentation: https://carrotwaxr.github.io/peek-stash-browser</li> <li>GitHub Issues: Bug reports and feature requests</li> <li>Stash Discord: #third-party-integrations channel</li> </ul>"},{"location":"reference/faq/#how-do-i-report-a-bug","title":"How do I report a bug?","text":"<ol> <li>Search existing issues first</li> <li>Gather logs and error messages</li> <li>Create detailed issue on GitHub</li> <li>Include: version, platform, steps to reproduce</li> </ol> <p>See: GitHub Issues</p>"},{"location":"reference/faq/#can-i-contribute","title":"Can I contribute?","text":"<p>Yes! Contributions are welcome: - Code improvements - Bug fixes - Documentation - Translations (future)</p> <p>See: GitHub Issues</p>"},{"location":"reference/faq/#next-steps","title":"Next Steps","text":"<ul> <li>Installation - Install Peek</li> <li>Watch History - Resume playback from where you left off</li> <li>Keyboard Navigation - Complete keyboard shortcuts and TV mode</li> <li>Playlists - Create and manage custom playlists</li> <li>Troubleshooting - Fix common issues</li> </ul>"},{"location":"reference/troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions for Peek Stash Browser.</p>"},{"location":"reference/troubleshooting/#installation-setup","title":"Installation &amp; Setup","text":""},{"location":"reference/troubleshooting/#container-wont-start","title":"Container Won't Start","text":"<p>Check logs first:</p> <pre><code>docker logs peek-stash-browser\n</code></pre> <p>Common causes:</p> <ul> <li>Missing required environment variables (<code>STASH_URL</code>, <code>STASH_API_KEY</code>)</li> <li>Invalid <code>STASH_URL</code> (not accessible from container)</li> <li>Port conflicts (6969 already in use)</li> <li>Missing volume mappings</li> </ul> <p>Solution:</p> <pre><code># Stop container\ndocker stop peek-stash-browser\n\n# Remove container\ndocker rm peek-stash-browser\n\n# Recreate with correct configuration\n# (use your template or docker-compose)\n</code></pre>"},{"location":"reference/troubleshooting/#cant-connect-to-stash","title":"Can't Connect to Stash","text":"<p>Test connectivity from container:</p> <pre><code>docker exec peek-stash-browser curl -X POST http://your-stash-ip:9999/graphql \\\n  -H \"Content-Type: application/json\" \\\n  -H \"ApiKey: your-api-key-12345\" \\\n  -d '{\n    \"query\": \"query FindTags { findTags(filter: { per_page: 1 }) { count tags { id name } } }\"\n  }'\n</code></pre> <p>Solutions:</p> <ul> <li>Verify <code>STASH_URL</code> is correct and accessible</li> <li>Check Stash API key is valid (Settings \u2192 Security \u2192 API Key)</li> <li>Ensure Stash GraphQL endpoint is enabled</li> <li>Check firewall rules between containers</li> </ul>"},{"location":"reference/troubleshooting/#video-playback","title":"Video Playback","text":""},{"location":"reference/troubleshooting/#videos-wont-play","title":"Videos Won't Play","text":"<ol> <li>Check FFmpeg: <code>docker exec peek-stash-browser ffmpeg -version</code></li> <li>Check file permissions: <code>docker exec peek-stash-browser ls -la /app/media</code></li> <li>Verify path mapping: Go to Settings \u2192 Path Mappings and use \"Test Path\" button</li> <li>Check media is mounted: <code>docker exec peek-stash-browser ls /app/media</code></li> <li>Check backend logs: <code>docker logs peek-stash-browser</code></li> </ol>"},{"location":"reference/troubleshooting/#slow-transcoding","title":"Slow Transcoding","text":"<p>Check I/O performance:</p> <pre><code>docker exec peek-stash-browser dd if=/app/media/test.mp4 of=/dev/null bs=1M count=100\n</code></pre> <p>Expected: 50+ MB/s for good performance</p> <p>Solutions:</p> <ul> <li>Move media to local storage (not network share)</li> <li>Use SSD for media and temp files</li> <li>Reduce quality preset</li> <li>Allocate more CPU to container</li> </ul>"},{"location":"reference/troubleshooting/#authentication","title":"Authentication","text":""},{"location":"reference/troubleshooting/#cant-login","title":"Can't Login","text":"<ul> <li>Verify username/password</li> <li>Check if cookies are enabled in browser</li> <li>Clear browser cache and cookies</li> <li>Try incognito/private browsing mode</li> </ul>"},{"location":"reference/troubleshooting/#session-expires-immediately","title":"Session Expires Immediately","text":"<ul> <li>Check <code>JWT_SECRET</code> is set</li> <li>Verify <code>SECURE_COOKIES</code> matches your setup (false for HTTP)</li> <li>Clear browser cookies</li> <li>Check system clock is correct</li> </ul>"},{"location":"reference/troubleshooting/#network-performance","title":"Network &amp; Performance","text":""},{"location":"reference/troubleshooting/#slow-page-loading","title":"Slow Page Loading","text":"<ul> <li>Check server CPU/memory usage</li> <li>Clear browser cache</li> <li>Verify network speed</li> <li>Check for console errors (F12 \u2192 Console)</li> </ul>"},{"location":"reference/troubleshooting/#images-not-loading","title":"Images Not Loading","text":"<ul> <li>Check Stash is accessible</li> <li>Verify <code>STASH_URL</code> is correct</li> <li>Check browser console for CORS errors</li> <li>Try clearing cache</li> </ul>"},{"location":"reference/troubleshooting/#database","title":"Database","text":""},{"location":"reference/troubleshooting/#database-locked-error","title":"Database Locked Error","text":"<pre><code># Stop container\ndocker stop peek-stash-browser\n\n# Remove lock file\ndocker run --rm -v peek-data:/app/data busybox rm /app/data/peek-db.db-wal\n\n# Restart container\ndocker start peek-stash-browser\n</code></pre>"},{"location":"reference/troubleshooting/#reset-database","title":"Reset Database","text":"<p>This Deletes All Data</p> <p>This will delete all users, preferences, and playlists.</p> <pre><code>docker stop peek-stash-browser\ndocker run --rm -v peek-data:/app/data busybox rm /app/data/peek-db.db\ndocker start peek-stash-browser\n</code></pre>"},{"location":"reference/troubleshooting/#logs-debugging","title":"Logs &amp; Debugging","text":""},{"location":"reference/troubleshooting/#viewing-logs","title":"Viewing Logs","text":"<pre><code># All logs\ndocker logs peek-stash-browser\n\n# Follow logs (live)\ndocker logs -f peek-stash-browser\n\n# Last 100 lines\ndocker logs --tail 100 peek-stash-browser\n</code></pre>"},{"location":"reference/troubleshooting/#enable-debug-logging","title":"Enable Debug Logging","text":"<p>Add to environment variables:</p> <pre><code>LOG_LEVEL=debug\n</code></pre>"},{"location":"reference/troubleshooting/#browser-console","title":"Browser Console","text":"<p>Check browser console for frontend errors:</p> <ol> <li>Press F12 to open DevTools</li> <li>Click Console tab</li> <li>Look for red errors</li> <li>Copy error messages when reporting issues</li> </ol>"},{"location":"reference/troubleshooting/#common-error-messages","title":"Common Error Messages","text":""},{"location":"reference/troubleshooting/#ffmpeg-not-found","title":"\"FFmpeg not found\"","text":"<p>Solution: FFmpeg should be included in the official image. If you see this error: - Pull the latest image: <code>docker pull carrotwaxr/peek-stash-browser:latest</code> - Rebuild your container with the latest image</p>"},{"location":"reference/troubleshooting/#path-not-found-or-path-related-errors","title":"\"Path not found\" or path-related errors","text":"<p>Solution: Check your path mappings: 1. Go to Settings \u2192 Path Mappings in Peek 2. Click Test Path for each mapping 3. Verify paths are accessible 4. Make sure media volumes are mounted to your container</p>"},{"location":"reference/troubleshooting/#session-not-found","title":"\"Session not found\"","text":"<p>Solution: Session expired (30 min timeout). Refresh page and try again.</p>"},{"location":"reference/troubleshooting/#unauthorized","title":"\"Unauthorized\"","text":"<p>Solution: Token expired. Logout and login again.</p>"},{"location":"reference/troubleshooting/#getting-help","title":"Getting Help","text":""},{"location":"reference/troubleshooting/#before-asking-for-help","title":"Before Asking for Help","text":"<ol> <li>Check this troubleshooting guide</li> <li>Search existing GitHub Issues</li> <li>Check browser console for errors</li> <li>Gather logs and error messages</li> </ol>"},{"location":"reference/troubleshooting/#creating-a-bug-report","title":"Creating a Bug Report","text":"<p>Include:</p> <ul> <li>Peek version: Check Settings \u2192 About</li> <li>Platform: unRAID / Docker / Development</li> <li>Browser: Chrome 120 / Firefox 121 / etc.</li> <li>Stash version: Your Stash server version</li> <li>Error logs: Backend and browser console</li> <li>Steps to reproduce: Detailed steps</li> <li>Screenshots: If applicable</li> </ul>"},{"location":"reference/troubleshooting/#where-to-get-help","title":"Where to Get Help","text":"<ul> <li>GitHub Issues: https://github.com/carrotwaxr/peek-stash-browser/issues</li> <li>Stash Discord: #third-party-integrations channel</li> <li>Documentation: https://carrotwaxr.github.io/peek-stash-browser</li> </ul>"},{"location":"reference/troubleshooting/#next-steps","title":"Next Steps","text":"<ul> <li>FAQ - Frequently asked questions</li> </ul>"},{"location":"user-guide/hidden-items/","title":"Hidden Items","text":""},{"location":"user-guide/hidden-items/#overview","title":"Overview","text":"<p>The Hidden Items feature allows you to hide specific content from your personal view without affecting other users. Unlike Content Restrictions (which are admin-controlled), Hidden Items are entirely user-controlled and work for all users including admins.</p> <p>Key Difference from Content Restrictions: - Content Restrictions: Set by admins, restrict what a user CAN see (e.g., exclude certain tags/studios) - Hidden Items: Set by users themselves, hide individual items they don't want to see</p>"},{"location":"user-guide/hidden-items/#how-to-hide-items","title":"How to Hide Items","text":""},{"location":"user-guide/hidden-items/#from-scene-cards","title":"From Scene Cards","text":"<ol> <li>Click the three-dot menu (\u22ee) on any scene card</li> <li>Select \"Hide Scene\"</li> <li>Confirm in the dialog (or check \"Don't ask again\" to skip future confirmations)</li> </ol>"},{"location":"user-guide/hidden-items/#from-entity-cards","title":"From Entity Cards","text":"<p>The same three-dot menu is available on: - Performer cards - Studio cards - Tag cards - Group/Collection cards - Gallery cards</p>"},{"location":"user-guide/hidden-items/#bulk-actions-scenes","title":"Bulk Actions (Scenes)","text":"<ol> <li>Enable multi-select mode by clicking the checkbox icon</li> <li>Select multiple scenes</li> <li>Click \"Hide Selected\" in the bulk action bar</li> </ol>"},{"location":"user-guide/hidden-items/#managing-hidden-items","title":"Managing Hidden Items","text":""},{"location":"user-guide/hidden-items/#viewing-hidden-items","title":"Viewing Hidden Items","text":"<ol> <li>Go to My Settings</li> <li>Scroll to the \"Hidden Items\" section</li> <li>Click View Hidden Items</li> </ol>"},{"location":"user-guide/hidden-items/#restoring-hidden-items","title":"Restoring Hidden Items","text":"<p>From the Hidden Items page: - Click Restore on individual items to unhide them - Click Restore All to restore all hidden items at once - Use the tabs to filter by entity type (Scenes, Performers, Studios, etc.)</p>"},{"location":"user-guide/hidden-items/#dont-ask-again","title":"Don't Ask Again","text":"<p>If you frequently hide items and want to skip the confirmation dialog: 1. Check \"Don't ask me again\" when hiding an item, OR 2. Go to My Settings &gt; Hidden Items section 3. Check \"Don't ask for confirmation when hiding items\"</p> <p>You can toggle this setting on/off at any time.</p>"},{"location":"user-guide/hidden-items/#how-it-works","title":"How It Works","text":""},{"location":"user-guide/hidden-items/#for-regular-users","title":"For Regular Users","text":"<ul> <li>Hidden items are filtered from all views (search, carousels, recommendations)</li> <li>Hidden items persist across sessions and page refreshes</li> <li>Other users are not affected by your hidden items</li> </ul>"},{"location":"user-guide/hidden-items/#for-admin-users","title":"For Admin Users","text":"<ul> <li>Admins can hide content for themselves just like regular users</li> <li>Content Restrictions (INCLUDE/EXCLUDE rules) are bypassed for admins</li> <li>Hidden Items filtering is ALWAYS applied, even for admins</li> <li>This allows admins to maintain full admin access while personalizing their own view</li> </ul>"},{"location":"user-guide/hidden-items/#cascading-behavior","title":"Cascading Behavior","text":"<p>When you hide an entity: - Hiding a Scene: Only that scene is hidden - Hiding a Performer: That performer and scenes where they appear may be affected - Hiding a Studio: That studio and scenes from it may be affected - Hiding a Tag: That tag and related content may be affected</p> <p>Note: The exact cascading behavior depends on your Content Restrictions settings and whether hidden entities are the only content associated with related items.</p>"},{"location":"user-guide/hidden-items/#faq","title":"FAQ","text":""},{"location":"user-guide/hidden-items/#can-i-accidentally-hide-something-important","title":"Can I accidentally hide something important?","text":"<p>You can always restore hidden items from My Settings &gt; View Hidden Items. The Restore All button makes it easy to undo bulk actions.</p>"},{"location":"user-guide/hidden-items/#do-hidden-items-count-toward-my-stats","title":"Do hidden items count toward my stats?","text":"<p>Hidden items are excluded from most views but may still appear in certain statistics or reports.</p>"},{"location":"user-guide/hidden-items/#can-admins-see-what-ive-hidden","title":"Can admins see what I've hidden?","text":"<p>Admins can see that you have hidden items (via database access) but the hidden items feature is designed for personal use. Each user's hidden items are private to them.</p>"},{"location":"user-guide/hidden-items/#what-happens-if-content-ive-hidden-is-updated-in-stash","title":"What happens if content I've hidden is updated in Stash?","text":"<p>Hidden items remain hidden even if the underlying content is modified in Stash. The hiding is based on entity ID, not content characteristics.</p> <p>Document Version: 1.0 Last Updated: 2025-01-21</p>"},{"location":"user-guide/keyboard-navigation/","title":"Keyboard Navigation &amp; TV Mode","text":"<p>Peek provides complete keyboard navigation, making it perfect for TV remotes, wireless keyboards, or couch browsing.</p>"},{"location":"user-guide/keyboard-navigation/#why-keyboard-navigation","title":"Why Keyboard Navigation?","text":"<ul> <li>TV Mode - Use Peek on your TV with just a remote</li> <li>Accessibility - Full keyboard support for users who prefer or require it</li> <li>Efficiency - Navigate faster without reaching for the mouse</li> <li>Couch Browsing - Control everything from your couch with a wireless keyboard</li> </ul>"},{"location":"user-guide/keyboard-navigation/#global-navigation","title":"Global Navigation","text":""},{"location":"user-guide/keyboard-navigation/#primary-navigation-keys","title":"Primary Navigation Keys","text":"Key Action <code>Tab</code> Move to next focusable element <code>Shift+Tab</code> Move to previous focusable element <code>Enter</code> Activate/click the focused element <code>Space</code> Activate buttons (also play/pause in video player) <code>Escape</code> Go back or close modals"},{"location":"user-guide/keyboard-navigation/#arrow-key-navigation","title":"Arrow Key Navigation","text":"<p>Arrow keys navigate through grid layouts and lists:</p> Key Action <code>\u2191</code> Move focus up (in grids and lists) <code>\u2193</code> Move focus down (in grids and lists) <code>\u2190</code> Move focus left (in grids) <code>\u2192</code> Move focus right (in grids) <p>Grid Navigation: - Scene grids automatically respond to arrow keys - Focus moves intelligently between rows and columns - Works on Scenes, Performers, Studios, Tags pages</p> <p>List Navigation: - Arrow up/down navigates vertical lists - Works in playlists, search results, settings</p>"},{"location":"user-guide/keyboard-navigation/#scene-browsing","title":"Scene Browsing","text":""},{"location":"user-guide/keyboard-navigation/#scene-grid-navigation","title":"Scene Grid Navigation","text":"<p>Navigating scene cards:</p> <ol> <li>Use <code>Tab</code> or arrow keys to focus a scene card</li> <li>Press <code>Enter</code> to open the scene detail page</li> <li>Press <code>Escape</code> to go back to the grid</li> </ol> <p>Quick actions on scene cards:</p> Key Action <code>Enter</code> Open scene detail page <code>P</code> Play scene immediately (when focused) <code>+</code> Add to playlist (opens playlist selector) <code>F</code> Toggle favorite (when supported)"},{"location":"user-guide/keyboard-navigation/#scene-detail-page","title":"Scene Detail Page","text":"<p>While viewing scene details:</p> Key Action <code>Space</code> or <code>Enter</code> Play video <code>Escape</code> Return to previous page <code>Tab</code> Navigate between action buttons"},{"location":"user-guide/keyboard-navigation/#video-player-controls","title":"Video Player Controls","text":""},{"location":"user-guide/keyboard-navigation/#playback-controls","title":"Playback Controls","text":"Key Action <code>Space</code> or <code>K</code> Play/Pause <code>\u2190</code> Seek backward 10 seconds <code>\u2192</code> Seek forward 10 seconds <code>Shift+\u2190</code> Seek backward 5 seconds <code>Shift+\u2192</code> Seek forward 5 seconds <code>Home</code> Jump to beginning <code>End</code> Jump to end <code>0-9</code> Jump to 0%-90% of video <p>Examples: - Press <code>5</code> to jump to 50% of the video - Press <code>0</code> to jump to the start - Press <code>9</code> to jump to 90%</p>"},{"location":"user-guide/keyboard-navigation/#volume-controls","title":"Volume Controls","text":"Key Action <code>\u2191</code> Increase volume <code>\u2193</code> Decrease volume <code>M</code> Mute/unmute"},{"location":"user-guide/keyboard-navigation/#display-controls","title":"Display Controls","text":"Key Action <code>F</code> Toggle fullscreen <code>Escape</code> Exit fullscreen <code>T</code> Toggle theater mode (when available)"},{"location":"user-guide/keyboard-navigation/#playlist-playback","title":"Playlist Playback","text":"<p>While playing a playlist:</p> Key Action <code>N</code> or <code>Shift+\u2192</code> Next scene in playlist <code>P</code> or <code>Shift+\u2190</code> Previous scene in playlist <code>S</code> Toggle shuffle <code>R</code> Cycle repeat mode (Off \u2192 All \u2192 One) <code>Escape</code> Exit playlist playback"},{"location":"user-guide/keyboard-navigation/#search-filtering","title":"Search &amp; Filtering","text":""},{"location":"user-guide/keyboard-navigation/#search-box","title":"Search Box","text":"Key Action <code>/</code> or <code>Ctrl+F</code> Focus search box (from anywhere) <code>Escape</code> Clear search and exit search box <code>Enter</code> Submit search / apply filters <code>\u2193</code> Move to search results (from search box)"},{"location":"user-guide/keyboard-navigation/#filter-controls","title":"Filter Controls","text":"<p>While using filters:</p> Key Action <code>Tab</code> Move between filter options <code>Space</code> Toggle checkbox filters <code>Enter</code> Apply filters <code>Escape</code> Close filter panel"},{"location":"user-guide/keyboard-navigation/#playlists","title":"Playlists","text":""},{"location":"user-guide/keyboard-navigation/#playlist-management","title":"Playlist Management","text":"Key Action <code>N</code> Create new playlist (when on Playlists page) <code>Enter</code> Open focused playlist <code>Delete</code> Delete focused playlist (with confirmation)"},{"location":"user-guide/keyboard-navigation/#editing-playlists","title":"Editing Playlists","text":"<p>In edit mode:</p> Key Action <code>Tab</code> Navigate between scenes <code>Delete</code> Remove focused scene from playlist <code>Escape</code> Exit edit mode <code>Enter</code> Save changes <p>Reordering scenes: - Use mouse drag-and-drop for reordering - Keyboard reordering not currently supported</p>"},{"location":"user-guide/keyboard-navigation/#tv-mode","title":"TV Mode","text":""},{"location":"user-guide/keyboard-navigation/#what-is-tv-mode","title":"What is TV Mode?","text":"<p>TV Mode is Peek's interface optimized for TV remotes and couch browsing:</p> <ul> <li>Large Focus Indicators - Easy to see what's selected from across the room</li> <li>Remote-Friendly Navigation - Arrow keys and Enter are all you need</li> <li>Auto-Scroll - Page scrolls to keep focused element visible</li> <li>Simplified Controls - Reduced clutter, bigger buttons</li> </ul>"},{"location":"user-guide/keyboard-navigation/#using-peek-on-tv","title":"Using Peek on TV","text":"<p>Recommended setup:</p> <ol> <li>Connect a computer to your TV (HDMI)</li> <li>Access Peek via web browser on that computer</li> <li>Use a wireless keyboard or TV remote (with keyboard features)</li> <li>Navigate entirely with arrow keys and Enter</li> </ol> <p>Popular remote options: - Amazon Fire TV remote (with Alexa) - Android TV remote apps - Wireless keyboards (Logitech K400, etc.) - Smart TV keyboards - Game controllers (via browser support)</p>"},{"location":"user-guide/keyboard-navigation/#tv-mode-tips","title":"TV Mode Tips","text":"<ol> <li>Use fullscreen browser mode (F11) for immersive experience</li> <li>Enable auto-hide cursor in your OS settings</li> <li>Increase font size in browser settings (Ctrl +)</li> <li>Use dark theme for better viewing in dark rooms</li> <li>Disable screen saver on your PC/TV</li> </ol>"},{"location":"user-guide/keyboard-navigation/#settings-navigation","title":"Settings Navigation","text":""},{"location":"user-guide/keyboard-navigation/#navigating-settings-pages","title":"Navigating Settings Pages","text":"Key Action <code>Tab</code> Move between settings sections <code>Enter</code> Open/edit focused setting <code>Space</code> Toggle switches and checkboxes <code>Escape</code> Cancel without saving"},{"location":"user-guide/keyboard-navigation/#saving-settings","title":"Saving Settings","text":"Key Action <code>Enter</code> Save changes (when focused on Save button) <code>Escape</code> Cancel changes"},{"location":"user-guide/keyboard-navigation/#modal-dialogs","title":"Modal Dialogs","text":""},{"location":"user-guide/keyboard-navigation/#dialog-controls","title":"Dialog Controls","text":"Key Action <code>Enter</code> Confirm action (OK, Save, Submit) <code>Escape</code> Cancel and close dialog <code>Tab</code> Navigate between dialog buttons <p>Examples: - Delete confirmation dialogs - Playlist selector - Add to playlist modal - Login form</p>"},{"location":"user-guide/keyboard-navigation/#accessibility-features","title":"Accessibility Features","text":""},{"location":"user-guide/keyboard-navigation/#focus-indicators","title":"Focus Indicators","text":"<p>Peek shows clear visual focus indicators:</p> <ul> <li>Blue outline around focused elements</li> <li>Highlighted cards when focused in grids</li> <li>Button highlights when focused</li> <li>Scale effect on focused scene cards</li> </ul>"},{"location":"user-guide/keyboard-navigation/#screen-reader-support","title":"Screen Reader Support","text":"<p>Basic screen reader support:</p> <ul> <li>Alt text on images</li> <li>ARIA labels on buttons and controls</li> <li>Semantic HTML for proper navigation</li> <li>Keyboard-accessible everything</li> </ul> <p>Screen Reader Support</p> <p>Screen reader support is improving but may not be perfect. Please report accessibility issues on GitHub.</p>"},{"location":"user-guide/keyboard-navigation/#customizing-keyboard-shortcuts","title":"Customizing Keyboard Shortcuts","text":"<p>Currently not customizable. Keyboard shortcuts are built-in and cannot be changed.</p> <p>Future enhancement: Custom keyboard shortcuts may be added in a future update.</p>"},{"location":"user-guide/keyboard-navigation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/keyboard-navigation/#keyboard-navigation-not-working","title":"Keyboard navigation not working","text":"<p>Solution: - Click anywhere in the browser window to focus it - Try pressing <code>Tab</code> to activate focus mode - Check if a modal or dialog is open (press <code>Escape</code>) - Disable browser extensions that may interfere - Try a different browser</p>"},{"location":"user-guide/keyboard-navigation/#focus-indicator-not-visible","title":"Focus indicator not visible","text":"<p>Solution: - Your browser theme may be hiding focus outlines - Try a different theme in Peek (Settings \u2192 My Settings) - Check browser zoom level (Ctrl + 0 to reset) - Report as a bug if it persists</p>"},{"location":"user-guide/keyboard-navigation/#arrow-keys-scroll-page-instead-of-navigating","title":"Arrow keys scroll page instead of navigating","text":"<p>Solution: - Click on the scene grid to focus it first - Use <code>Tab</code> to focus an element, then arrow keys work - Some areas use <code>Tab</code> navigation only</p>"},{"location":"user-guide/keyboard-navigation/#video-player-shortcuts-not-working","title":"Video player shortcuts not working","text":"<p>Solution: - Make sure video player is focused (click on it) - Some shortcuts only work during playback - Check if another app is intercepting keys - Try clicking the video before using shortcuts</p>"},{"location":"user-guide/keyboard-navigation/#tips-for-power-users","title":"Tips for Power Users","text":""},{"location":"user-guide/keyboard-navigation/#speed-navigation","title":"Speed Navigation","text":"<ol> <li>Use <code>/</code> to search instantly from any page</li> <li>Use number keys (0-9) to scrub through videos quickly</li> <li>Press <code>Escape</code> repeatedly to navigate back multiple levels</li> <li>Use <code>Tab + Enter</code> combo for rapid clicking</li> </ol>"},{"location":"user-guide/keyboard-navigation/#couch-potato-mode","title":"Couch Potato Mode","text":"<p>Perfect setup for couch browsing:</p> <ol> <li>Open Peek in fullscreen (F11)</li> <li>Create a \"Favorites\" playlist</li> <li>Start playlist playback</li> <li>Use only these keys:</li> <li><code>Space</code> - Play/Pause</li> <li><code>N</code> - Next video</li> <li><code>P</code> - Previous video</li> <li><code>\u2191/\u2193</code> - Volume</li> <li><code>F</code> - Fullscreen on/off</li> </ol>"},{"location":"user-guide/keyboard-navigation/#workflow-optimization","title":"Workflow Optimization","text":"<p>Browse and queue efficiently:</p> <ol> <li>Navigate scene grid with arrow keys</li> <li>Press <code>+</code> on scenes you want to watch</li> <li>Add all to \"Watch Later\" playlist</li> <li>Open playlist and press Play</li> <li>Lean back and enjoy</li> </ol>"},{"location":"user-guide/keyboard-navigation/#next-steps","title":"Next Steps","text":"<ul> <li>Watch History - Resume playback from where you left off</li> <li>Playlists - Create and manage custom playlists</li> <li>Quick Start Guide - Get started with Peek</li> </ul>"},{"location":"user-guide/playlists/","title":"Playlists","text":"<p>Create and manage custom playlists to organize your favorite scenes.</p>"},{"location":"user-guide/playlists/#creating-a-playlist","title":"Creating a Playlist","text":"<ol> <li>Click Playlists in the navigation menu</li> <li>Click the Create Playlist button</li> <li>Enter a name for your playlist</li> <li>Optionally add a description</li> <li>Click Create</li> </ol> <p>Your new playlist is now ready to use!</p>"},{"location":"user-guide/playlists/#adding-scenes-to-playlists","title":"Adding Scenes to Playlists","text":"<p>There are two ways to add scenes to your playlists:</p>"},{"location":"user-guide/playlists/#from-scene-cards","title":"From Scene Cards","text":"<ol> <li>Find a scene you want to add (on any page with scene cards)</li> <li>Click the + (plus) icon on the scene card</li> <li>Select the playlist you want to add it to</li> <li>The scene is added instantly!</li> </ol>"},{"location":"user-guide/playlists/#from-scene-detail-page","title":"From Scene Detail Page","text":"<ol> <li>Click on a scene to open its detail page</li> <li>Click the Add to Playlist button</li> <li>Select the playlist you want to add it to</li> <li>Done!</li> </ol> <p>Multiple Playlists</p> <p>You can add the same scene to multiple playlists. Great for organizing scenes by different themes or moods!</p>"},{"location":"user-guide/playlists/#managing-your-playlists","title":"Managing Your Playlists","text":""},{"location":"user-guide/playlists/#viewing-playlist-contents","title":"Viewing Playlist Contents","text":"<ol> <li>Click Playlists in the navigation</li> <li>Click on any playlist to see its scenes</li> <li>Scroll through to see all scenes in the playlist</li> </ol>"},{"location":"user-guide/playlists/#editing-playlist-details","title":"Editing Playlist Details","text":"<ol> <li>Open a playlist</li> <li>Click the Edit button (pencil icon)</li> <li>Change the name or description</li> <li>Click Save</li> </ol>"},{"location":"user-guide/playlists/#reordering-scenes","title":"Reordering Scenes","text":"<p>Want to change the playback order?</p> <ol> <li>Open a playlist</li> <li>Click Edit mode</li> <li>Drag and drop scenes to reorder them</li> <li>Click Save when done</li> </ol> <p>The playlist will play scenes in the order you've arranged them.</p>"},{"location":"user-guide/playlists/#removing-scenes","title":"Removing Scenes","text":"<ol> <li>Open a playlist</li> <li>Click Edit mode</li> <li>Click the \u00d7 (remove) icon on any scene</li> <li>Confirm removal</li> <li>Click Save</li> </ol>"},{"location":"user-guide/playlists/#deleting-a-playlist","title":"Deleting a Playlist","text":"<p>Permanent Action</p> <p>Deleting a playlist cannot be undone. The scenes themselves are not deleted, just the playlist.</p> <ol> <li>Open the playlist you want to delete</li> <li>Click the Delete button (trash icon)</li> <li>Confirm deletion</li> <li>The playlist is permanently removed</li> </ol>"},{"location":"user-guide/playlists/#playing-playlists","title":"Playing Playlists","text":""},{"location":"user-guide/playlists/#basic-playback","title":"Basic Playback","text":"<ol> <li>Open a playlist</li> <li>Click the Play button</li> <li>Playback starts with the first scene</li> <li>When a scene ends, the next scene plays automatically</li> </ol>"},{"location":"user-guide/playlists/#shuffle-mode","title":"Shuffle Mode","text":"<p>Randomize the playback order:</p> <ol> <li>Open a playlist</li> <li>Click the Shuffle button (shuffle icon)</li> <li>Playlist will play scenes in random order</li> <li>Click Shuffle again to turn it off</li> </ol> <p>Shuffle Tip</p> <p>Shuffle is perfect for long playlists when you want variety!</p>"},{"location":"user-guide/playlists/#repeat-modes","title":"Repeat Modes","text":"<p>Choose how playback repeats:</p> <p>Repeat Off (default) - Playlist plays once and stops</p> <p>Repeat All - When playlist ends, it starts over from the beginning - Continues until you stop it</p> <p>Repeat One - Current scene repeats continuously - Great for favorite scenes!</p> <p>To change repeat mode: 1. Open a playlist 2. Click the Repeat button 3. Click again to cycle through modes: Off \u2192 All \u2192 One \u2192 Off</p>"},{"location":"user-guide/playlists/#navigation-during-playback","title":"Navigation During Playback","text":"<p>While watching a playlist:</p> <ul> <li>Next Scene: Click the next button or press N</li> <li>Previous Scene: Click the previous button or press P</li> <li>Exit Playlist: Click the back button to return to browsing</li> </ul>"},{"location":"user-guide/playlists/#playlist-tips-tricks","title":"Playlist Tips &amp; Tricks","text":""},{"location":"user-guide/playlists/#organization-ideas","title":"Organization Ideas","text":"<ul> <li>By Performer: Create playlists for your favorite performers</li> <li>By Studio: Group scenes from specific studios</li> <li>By Theme: Organize by categories or tags</li> <li>Watch Later: Save scenes you want to watch later</li> <li>Best Of: Curate your absolute favorites</li> <li>Mood-Based: Create playlists for different moods or occasions</li> </ul>"},{"location":"user-guide/playlists/#quick-access","title":"Quick Access","text":"<p>Your playlists are always accessible from: - The Playlists page (shows all playlists) - Any scene's Add to Playlist menu - The + icon on scene cards</p>"},{"location":"user-guide/playlists/#playlist-size","title":"Playlist Size","text":"<p>There's no limit to how many: - Playlists you can create - Scenes you can add to a playlist - Playlists a single scene can be in</p>"},{"location":"user-guide/playlists/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/playlists/#scene-wont-add-to-playlist","title":"Scene won't add to playlist","text":"<ul> <li>Make sure you're logged in</li> <li>Check that the playlist still exists</li> <li>Try refreshing the page</li> </ul>"},{"location":"user-guide/playlists/#playlist-wont-play","title":"Playlist won't play","text":"<ul> <li>Verify the playlist has scenes in it</li> <li>Check that you can play individual scenes</li> <li>Make sure your path mappings are configured correctly</li> </ul>"},{"location":"user-guide/playlists/#changes-arent-saving","title":"Changes aren't saving","text":"<ul> <li>Make sure to click Save after editing</li> <li>Check your internet connection</li> <li>Try refreshing and making changes again</li> </ul>"},{"location":"user-guide/playlists/#next-steps","title":"Next Steps","text":"<ul> <li>Watch History - Resume playback from where you left off</li> <li>Keyboard Navigation - Complete keyboard shortcuts and TV mode</li> <li>Troubleshooting - Fix common issues</li> <li>FAQ - Frequently asked questions</li> </ul>"},{"location":"user-guide/watch-history/","title":"Watch History &amp; Resume Playback","text":"<p>Peek automatically tracks your viewing progress and lets you resume playback exactly where you left off.</p>"},{"location":"user-guide/watch-history/#how-watch-history-works","title":"How Watch History Works","text":""},{"location":"user-guide/watch-history/#automatic-tracking","title":"Automatic Tracking","text":"<p>Peek tracks your progress automatically while you watch:</p> <ul> <li>Progress is saved every few seconds during playback</li> <li>No manual action needed - just watch normally</li> <li>Per-user tracking - each user has their own watch history</li> <li>Syncs across devices - resume on any device where you're logged in</li> </ul>"},{"location":"user-guide/watch-history/#what-gets-tracked","title":"What Gets Tracked","text":"<p>For each scene you watch, Peek remembers:</p> <ul> <li>Current position - Exact timestamp where you stopped</li> <li>Total progress - Percentage watched (e.g., 65% complete)</li> <li>Last watched date - When you last viewed this scene</li> <li>Watch count - How many times you've watched it</li> </ul>"},{"location":"user-guide/watch-history/#resume-playback","title":"Resume Playback","text":""},{"location":"user-guide/watch-history/#automatic-resume","title":"Automatic Resume","text":"<p>When you click Play on a scene you've partially watched:</p> <ol> <li>Video player opens</li> <li>You see a \"Resume from [timestamp]\" notification</li> <li>Player automatically jumps to where you left off</li> <li>Click \"Start from beginning\" if you prefer to restart</li> </ol> <p>Quick Resume</p> <p>The resume prompt appears for 5 seconds. If you do nothing, playback continues from your last position automatically!</p>"},{"location":"user-guide/watch-history/#from-scene-cards","title":"From Scene Cards","text":"<p>Scene cards show your progress visually:</p> <ul> <li>Progress bar at the bottom of the thumbnail</li> <li>Percentage indicator (e.g., \"65% watched\")</li> <li>Blue progress bar fills from left to right as you watch</li> </ul> <p>To resume from a scene card: 1. Find the scene (look for the progress bar) 2. Click Play 3. Playback resumes automatically</p>"},{"location":"user-guide/watch-history/#continue-watching","title":"Continue Watching","text":""},{"location":"user-guide/watch-history/#quick-access-to-in-progress-scenes","title":"Quick Access to In-Progress Scenes","text":"<p>The Continue Watching section shows all partially-watched scenes:</p> <p>Location: Home page (top section)</p> <p>What appears here: - Scenes you've started but not finished - Sorted by most recently watched - Shows progress percentage - Limited to your last 20 in-progress scenes</p> <p>To resume: 1. Go to Home page 2. Find the scene in Continue Watching 3. Click Play 4. Resumes from where you stopped</p> <p>Fast Resume</p> <p>Continue Watching is the fastest way to pick up where you left off!</p>"},{"location":"user-guide/watch-history/#when-scenes-disappear-from-continue-watching","title":"When Scenes Disappear from Continue Watching","text":"<p>A scene is removed from Continue Watching when: - You watch to completion (95%+ watched counts as complete) - You manually clear watch history for that scene - It falls outside your last 20 in-progress scenes</p>"},{"location":"user-guide/watch-history/#managing-watch-history","title":"Managing Watch History","text":""},{"location":"user-guide/watch-history/#viewing-your-history","title":"Viewing Your History","text":"<p>Full watch history coming in future update. Currently:</p> <ul> <li>View in-progress scenes via Continue Watching on home page</li> <li>See progress bars on scene cards throughout the app</li> <li>Check scene detail page for watch progress</li> </ul>"},{"location":"user-guide/watch-history/#marking-as-watched","title":"Marking as Watched","text":"<p>To mark a scene as fully watched without watching it:</p> <ol> <li>Open the scene detail page</li> <li>Seek to the end of the video (last 5%)</li> <li>Let it play for a few seconds</li> <li>Scene is marked as watched</li> </ol> <p>Or manually skip to 95%+ completion to trigger \"watched\" status.</p>"},{"location":"user-guide/watch-history/#clearing-watch-history","title":"Clearing Watch History","text":"<p>For a single scene:</p> <ol> <li>Open the scene detail page</li> <li>Click the \u22ee (three dots) menu</li> <li>Select \"Clear watch history\"</li> <li>Progress is reset to 0%</li> </ol> <p>For all scenes:</p> <ol> <li>Go to Settings \u2192 My Settings</li> <li>Scroll to Watch History section</li> <li>Click \"Clear all watch history\"</li> <li>Confirm the action</li> <li>All progress is reset</li> </ol> <p>Cannot Be Undone</p> <p>Clearing watch history is permanent. You cannot restore cleared progress.</p>"},{"location":"user-guide/watch-history/#privacy-data","title":"Privacy &amp; Data","text":""},{"location":"user-guide/watch-history/#whats-stored","title":"What's Stored","text":"<p>Watch history is stored in Peek's database:</p> <ul> <li>User ID - Associated with your account</li> <li>Scene ID - Which scene you watched</li> <li>Progress position - Timestamp (in seconds)</li> <li>Last watched date - When you last viewed it</li> <li>Watch count - Total number of views</li> </ul>"},{"location":"user-guide/watch-history/#whats-not-stored","title":"What's NOT Stored","text":"<ul> <li>No video file access logs - Peek doesn't log file system access</li> <li>No sharing with Stash - Watch history stays in Peek only</li> <li>No external tracking - History never leaves your Peek instance</li> </ul>"},{"location":"user-guide/watch-history/#privacy-controls","title":"Privacy Controls","text":"<ul> <li>Per-user isolation - You only see your own history</li> <li>Admin cannot see - Even admins can't view other users' watch history</li> <li>Clear anytime - You control your history data</li> </ul>"},{"location":"user-guide/watch-history/#watch-history-tips","title":"Watch History Tips","text":""},{"location":"user-guide/watch-history/#efficient-binge-watching","title":"Efficient Binge Watching","text":"<ol> <li>Start watching scenes you want to explore</li> <li>Switch between different scenes freely</li> <li>Return to Continue Watching to resume any of them</li> <li>No need to finish in one sitting</li> </ol>"},{"location":"user-guide/watch-history/#organize-with-playlists","title":"Organize with Playlists","text":"<p>Combine watch history with playlists:</p> <ol> <li>Create a \"To Watch\" playlist</li> <li>Add scenes you plan to watch later</li> <li>Watch them at your own pace</li> <li>Progress tracked automatically</li> <li>Resume from Continue Watching or the playlist</li> </ol>"},{"location":"user-guide/watch-history/#track-rewatches","title":"Track Rewatches","text":"<p>Want to rewatch a favorite scene?</p> <ol> <li>Click Play on an already-watched scene</li> <li>Choose \"Start from beginning\" when prompted</li> <li>Watch count increments</li> <li>New progress tracked</li> </ol>"},{"location":"user-guide/watch-history/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/watch-history/#resume-not-working","title":"Resume not working","text":"<p>Solution: - Make sure you're logged in (watch history is per-user) - Check that you watched for at least 10 seconds (minimum tracking threshold) - Verify you're using the same user account - Try refreshing the page</p>"},{"location":"user-guide/watch-history/#progress-bar-not-showing","title":"Progress bar not showing","text":"<p>Solution: - Progress may not appear if you only watched a few seconds - Progress bars require at least 5% completion to display - Try playing the video for longer - Clear browser cache if progress seems stuck</p>"},{"location":"user-guide/watch-history/#continue-watching-is-empty","title":"Continue Watching is empty","text":"<p>Possible reasons: - You haven't started watching any scenes yet - All your in-progress scenes are completed - You cleared your watch history - You're using a different user account</p>"},{"location":"user-guide/watch-history/#progress-resets-unexpectedly","title":"Progress resets unexpectedly","text":"<p>Solution: - Check if someone else cleared watch history (admin action) - Verify you're logged in (anonymous users don't save history) - Check browser console for errors (F12 \u2192 Console) - Report as a bug if it persists</p>"},{"location":"user-guide/watch-history/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"<p>While watching a video:</p> Key Action <code>\u2190</code> Seek backward 10s <code>\u2192</code> Seek forward 10s <code>Space</code> Play/Pause <code>F</code> Toggle fullscreen <code>M</code> Mute/unmute <p>See the Keyboard Navigation Guide for complete shortcuts.</p>"},{"location":"user-guide/watch-history/#next-steps","title":"Next Steps","text":"<ul> <li>Keyboard Navigation - Complete keyboard shortcuts and TV mode</li> <li>Playlists - Organize scenes into custom playlists</li> <li>Quick Start Guide - Get started with Peek</li> </ul>"}]}